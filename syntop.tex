\documentclass{article}
\input{decls}
\usepackage[status=draft]{fixme}
\title{Unifying constructive general topology}
\author{Toby Bartels and Michael Shulman}
\def\R{\mathbb{R}}
\def\Re{\overline{\mathbb{R}}}
\def\Rp{[0,\infty]}
%\def\Rpf{[0,\infty)}
\def\F{\mathcal{F}}
\def\apart{\mathrel{\#}}
\def\napprox{\not\approx}
\def\nle{\not\le}
\def\oapt{\mathrel{\!\not\,\not\lesssim}}
\def\leapx{\lesssim}
\def\int{\mathrm{int}}
\def\ext{\mathrm{ext}}
\def\cl{\mathrm{cl}}
\def\cpl#1{\neg #1}
\let\implies\Rightarrow
\def\inv{^{-1}}
\def\hfep{\frac{\ep}{2}}
\def\fep#1#2{\frac{\if1#1\else#1\fi\ep}{#2}}
\def\singleton#1{\{#1\}}
\def\anti{\mathfrak{A}}
\def\neigh{\mathfrak{Z}}
\def\nn{\ensuremath{\neg\neg}}
% Categories
\def\Set{\mathbf{Set}}
\def\Preord{\mathbf{Preord}}
\def\APreord{\mathbf{APreord}}
\def\PTop{\mathbf{pTop}}
\def\Top{\mathbf{Top}}
\def\PTopnn{\mathbf{pTop}_{\nn}}
\def\ldTop{\mathbf{Top}_{\mathbf{ld}}}
\def\APTop{\mathbf{pATop}}
\def\ATop{\mathbf{ATop}}
\def\APTopnn{\mathbf{pATop}_{\nn}}
\def\ldATop{\mathbf{ATop}_{\mathbf{ld}}}
\def\Unif{\mathbf{Unif}}
\def\Unifnn{\mathbf{Unif}_{\nn}}
\def\ldUnif{\mathbf{Unif}_{\mathbf{ld}}}
\def\AUnif{\mathbf{AUnif}}
\def\AUnifnn{\mathbf{AUnif}_{\nn}}
\def\ldAUnif{\mathbf{AUnif}_{\mathbf{ld}}}
\begin{document}
\maketitle

\section{Introduction}
\label{sec:intro}

Guiding principles:
\begin{enumerate}
\item Category theory.  Large categories should be well-behaved, constructions should be functorial and natural and related by universal properties.
\item Nice categories including not-nice objects.  In particular, only impose separation axioms when needed, and include trivial cases like the empty set.
\item There's nothing intrinsically wrong with points, although they don't tell the whole story.
\item There's nothing intrinsically wrong with negation, as long as it is used correctly.
  For instance, $x\le y$ can be defined for real numbers as $\neg(y<x)$.
\item Topos-valid mathematics.  Equality means equality; it doesn't have to be ``proved'' that a function respects equality.  Sets don't come with a God-given apartness relation; indeed an apartness is a sort of topological structure that a set can be \emph{equipped} with.
\end{enumerate}


\section{Metric, gauge, and prometric spaces}
\label{sec:metric}

Arguably, the goal of general topology is to describe ``spaces'' that are not metrizable but share many attributes of metric spaces.
Thus, it is worth recalling the basic definitions and properties of metric spaces in a constructive context.

We write $\Re$ for the set of extended Dedekind real numbers; these are pairs $(L,U)$ of sets of rational numbers such that:
\begin{enumerate}
\item if $x\in L$ and $y\in U$ then $x<y$,
\item $x\in L$ if and only if there is a $y\in L$ with $x<y$ (roundedness),
\item $y\in U$ if and only if there is an $x\in U$ with $x<y$ (roundedness), and
\item if $x<y$ then either $x\in L$ or $y\in U$ (locatedness).
\end{enumerate}
If we also required $L$ and $U$ to be inhabited, we would get the set $\R$ of ordinary Dedekind real numbers.
In classical mathematics, $\Re$ differs from $\R$ only by including $+\infty = (\mathbb{Q},\emptyset)$ and $-\infty = (\emptyset,\mathbb{Q})$.
Constructively, we can say that $\R = \setof{ x\in \Re | -\infty < x < \infty }$.
We also write
\[\Rp = \setof{x\in\Re | x\ge 0 }.\]
We remind the reader that constructively, the (extended) real numbers admit both a strict order $<$ and a non-strict order $\le$, where $x\le y$ is equivalent to $\neg(y<x)$, but $x<y$ is stronger than $\neg(y\le x)$, and $x\le y$ is weaker than $(x=y)\lor (x<y)$.

\begin{defn}
  An \textbf{extended quasi-pseudo-metric space} is a set $X$ together with a function $d:X\times X \to \Rp$ such that
  \begin{enumerate}
  \item $d(x,x)=0$ for all $x\in X$ (reflexivity), and
  \item $d(x,z)\le d(x,y)+d(y,z)$ for all $x,y,z\in X$ (transitivity, or the triangle inequality).
  \end{enumerate}
  A \textbf{quasi-pseudo-metric space} is an extended quasi-pseudo-metric space such that
  \begin{enumerate}[resume]
  \item $d(x,y)<\infty$ for all $x,y\in X$ (finite distances).
  \end{enumerate}
  A \textbf{pseudo-metric space} is a quasi-pseudo-metric space such that
  \begin{enumerate}[resume]
  \item $d(x,y)=d(y,x)$ for all $x,y\in X$ (symmetry).
  \end{enumerate}
  A \textbf{metric space} is a pseudo-metric space such that
  \begin{enumerate}[resume]
  \item if $d(x,y)=0$ then $x=y$ (separation).
  \end{enumerate}
\end{defn}

Most of the above terminology is so well-established that we have not attempted to depart from it, but despite their derogatory-sounding name it is really the extended quasi-pseudo-metric spaces that are the fundamental notion.
The additional requirements imposed on a pseudo-metric or metric space are really \emph{separation axioms}, and experience in general topology has shown that a better category is obtained by only imposing separation axioms when necessary rather than including them in definitions.
And allowing infinite distances is arguably of little import topologically.
Moreover, Lawvere~\cite{lawvere:metric-spaces} exhibited extended quasi-pseudo-metric spaces as categories enriched over $(\Rp,\ge,+)$, placing them in a wider context.\fxnote{Should we mention the enriched-multicategory approach to other topological structures?}

In fact, most topological constructions on metric spaces can easily be generalized to the following structures.

\begin{defn}
  An \textbf{(extended) (quasi-)gauge space} is a set $X$ equipped with a set (called a \textbf{gauge}) whose elements are (extended) (quasi-)pseudo-metrics on $X$ (called \textbf{gauging distances}) such that:
  \begin{enumerate}
  \item there exists some gauging distance (nullary filtration), and
  \item if $d_1$ and $d_2$ are gauging distances, there is a gauging distance $d_3$ such that $d_1(x,y)\le d_3(x,y)$ and $d_2(x,y)\le d_3(x,y)$ for all $x,y\in X$ (binary filtration).
  \end{enumerate}
  An extended quasi-gauge space is\dots
  \begin{enumerate}[resume]
  \item $\mathbf{T_1}$ if for any $x,y\in X$, if $d(x,y)=0$ for all gauging distances $d$, then $x=y$.
  \item $\mathbf{T_0}$ if for any $x,y\in X$, if $d(x,y)=0$ and $d(y,x)=0$ for all gauging distances $d$, then $x=y$.
  \end{enumerate}
\end{defn}

In other words, a gauge is a filterbase in the poset of (extended quasi-)pseudo-metrics.
Note that the qualifiers ``extended'' and ``quasi-'' carry over from the metrics to the gauge, but all the metrics in a gauge space are automatically assumed to be pseudo; separatedness is named as additional properties that involve all the gauging distances at once.
Evidently the separation axioms $T_0$ and $T_1$ coincide in the symmetric case (gauge spaces), in which case they also imply the stronger topological separation axiom $T_2$ (Hausdorff), as well as $T_3$ (regularity).
Thus, such a space is commonly called simply \textbf{separated}; but in the non-symmetric case it seems worth distinguishing different kinds of separation.

Of course, any (extended quasi-)pseudo-metric space defines an (extended quasi-)gauge space with exactly one gauging distance.
The essential difference between gauge spaces and metric spaces is that gauge spaces need not be ``countable'' in any of the senses that metric spaces must.
For instance, any family of gauge spaces $\{X_k\}_{k\in K}$ has a product $\prod_k X_k$ with gauging distances of the form $d(x,y) = \max(d_1(\pi_{k_1}(x),\pi_{k_1}(y)),\dots,d_n(\pi_{k_n}(x),\pi_{k_n}(y)))$ where each $d_i$ is a gauging distance on $X_{k_i}$.
An analogous construction for metric spaces only works if $K$ is finite (a slightly subtler one works if it is countable).

Yet more general than gauge spaces are prometric spaces~\cite{cht:one-setting}:

\begin{defn}
  A \textbf{prometric space} is a set $X$ equipped with a set of functions $d:X\times X\to\Rp$, called \textbf{distances}, such that:
  \begin{enumerate}
  \item there exists a distance (nullary filtration),
  \item if $d_1$ and $d_2$ are distances, there is a distance $d_3$ such that $d_1(x,y)\le d_3(x,y)$ and $d_2(x,y)\le d_3(x,y)$ for all $x,y\in X$ (binary filtration),
  \item $d(x,x)=0$ for every distance and all $x\in X$ (reflexivity),
  \item for any distance $d_1$ there is a distance $d_2$ such that $d_1(x,z)\le d_2(x,y)+d_2(y,z)$ for all $x,y,z\in X$ (transitivity, or the triangle inequality).
  \end{enumerate}
  A prometric space is\dots
  \begin{enumerate}[resume]
  \item \textbf{symmetric} if for any distance $d_1$ there is a distance $d_2$ such that $d_1(x,y)\le d_2(y,x)$ for all $x,y\in X$.
  \item $\mathbf{T_1}$ if for any $x,y\in X$, if $d(x,y)=0$ for all distances $d$, then $x=y$.
  \item $\mathbf{T_0}$ if for any $x,y\in X$, if $d(x,y)=0$ and $d(y,x)=0$ for all distances $d$, then $x=y$.
  \end{enumerate}
\end{defn}

Since the terminology for prometric spaces is not well-established, we follow~\cite{cht:one-setting} in taking the ``extended quasi'' case to be the default, with symmetry stated explicitly whenever assumed.
Obviously any extended quasi-gauge is also a prometric.
We do not know any important examples of the extra generality afforded by prometric spaces, but they seem a natural level of generality; almost everything we have to say about metric spaces or gauge spaces in this paper applies just as well to prometric ones.

On the other hand, in constructive mathematics a very different (and much more general) notion is obtained by allowing distances to take values in the (nonnegative extended) \emph{upper} real numbers (sets $U$ of rational numbers satisfying the single axiom ``$y\in U$ if and only if there is an $x\in U$ with $x<y$'', plus $0\notin U$ for nonnegativity).
In this case we will speak of an \textbf{upper prometric space}.\fxnote{What about lower reals?}
%If necessary, we distinguish ordinary real numbers from upper ones by calling them \textbf{located}, and ordinary prometric spaces from upper ones by calling them \textbf{decomposable}.

The main difference is that unlike located real numbers, upper real numbers constructively admit arbitrary infima.
Thus, for instance, any set $X$ admits a \emph{discrete} upper prometric with one distance defined by $d(x,y) = \inf \setof{ 0 | x=y }$, so that $d(x,x)=0$ but $d(x,y)=+\infty$ if $x\neq y$.
This distance takes real values if and only if $X$ has decidable equality, since if $d(x,y)$ were real then it would be either $<2$ (in which case $x=y$) or $>1$ (in which case $x\neq y$).
As we will see, locatedness of distances is crucial for the special behavior of (pro)metric spaces among arbitrary spaces in constructive mathematics.
We will return to upper prometric spaces briefly in \cref{sec:uniformity}.

A metric space, and even a prometric space, contains a lot of information.
Some of that information is \emph{numerical}, since points are compared by real number distances.
However, for many purposes we are only interested in ``topological'' or ``geometric'' features that are, for instance, invariant with respect to scaling of distances.
Category-theoretically, this means we consider (pro)metric spaces as the objects of various different categories.
The two primary types of morphism we will be interested in are the following.
(Here $X$ and $Y$ denote prometric spaces; $\ep$ and $\de$ are assumed to range over $\Rp$; and $d_X$ and $d_Y$ are assumed to range over distances on $X$ and $Y$ respectively.)

\begin{itemize}
\item A function $f:X\to Y$ is \textbf{continuous} if for all $x\in X$, $d_Y$, and $\ep>0$ there are $d_X$ and $\de>0$ such that for all $y\in X$, if $d_X(x,y)<\de$ then $d_Y(f(x),f(y))<\ep$.
\item Similarly, $f:X\to Y$ is \textbf{uniformly continuous} if for all $d_Y$ and $\ep>0$ there are $d_X$ and $\de>0$ such that for all $x,y\in X$, if $d_X(x,y)<\de$ then $d_Y(f(x),f(y))<\ep$.
% \item We will say $f:X\to Y$ is \textbf{cocontinuous}\fxwarning{Does this have a standard name?} if for all $x\in X$, $d_Y$, and $\ep>0$ there are $d_X$ and $\de>0$ such that for all $y\in X$, if $d_Y(f(x),f(y))>\ep$ then $d_X(x,y)>\de$.
% \item Similarly, $f:X\to Y$ is \textbf{uniformly cocontinuous} if for all $d_Y$ and $\ep>0$ there are $d_X$ and $\de>0$ such that for all $x,y\in X$, if $d_Y(f(x),f(y))>\ep$ then $d_X(x,y)>\de$.
\end{itemize}

The locatedness of distances enables us to characterize continuity in a converse fashion:

\begin{lem}\label{thm:cocontinuous}
  For prometric spaces $X$ and $Y$, a function $f:X\to Y$ is continuous if and only if for all $x\in X$, $d_Y$, and $\ep>0$ there are $d_X$ and $\de>0$ such that for all $y\in X$, if $d_Y(f(x),f(y))>\ep$ then $d_X(x,y)>\de$.
\end{lem}
\begin{proof}
  If $f$ is continuous, then given $d_Y$ and $\ep$, let $d_X$ and $\de$ be as in the definition of continuity.
  Then if $d_Y(f(x),f(y)) > \ep$, we cannot have $d_X(x,y) < \de$, so we must have $d_X(x,y) > \frac{\de}{2}$.

  Conversely, if the stated condition holds, then given $d_Y$ and $\ep$, let $d_X$ and $\de$ be such that $d_Y(f(x),f(y))>\hfep \implies d_X(x,y)>\de$.
  Then if $d_X(x,y)<\de$, we cannot have $d_Y(f(x),f(y))>\hfep$, so we must have $d_Y(f(x),f(y))<\ep$.
\end{proof}

\begin{lem}\label{thm:unif-cocontinuous}
  For prometric spaces $X$ and $Y$, a function $f:X\to Y$ is uniformly continuous if and only if for all $d_Y$ and $\ep>0$ there are $d_X$ and $\de>0$ such that for all $x,y\in X$, if $d_Y(f(x),f(y))>\ep$ then $d_X(x,y)>\de$.
\end{lem}
\begin{proof}
  Entirely analogous.
\end{proof}

These lemmas are the beginning of the duality between ``closeness'' and ``apartness'' that will occupy us for much of the paper.

Among the notions that are invariants of continuity or uniform continuity are convergence and completeness.
When there is only one prometric space $X$, we assume that the letter $d$ ranges over distances on $X$.

\begin{itemize}
\item $X$ is \textbf{totally bounded} if for all $d$ and $\ep>0$ there is a finite set $F\subseteq X$ such that for all $y\in X$ there is an $x\in F$ such that $d(x,y)<\ep$.
\item A sequence $\{x_n\}$ in $X$ \textbf{converges} to $x\in X$ if for every $d$ and $\ep>0$ there is an $N$ such that for any $n$, if $n>N$ then $d(x,x_n)<\ep$.
\item More generally, a filter $\F$ in $X$ \textbf{converges} to $x\in X$ if for every $d$ and $\ep>0$ there is an $A\in\F$ such that for all $y\in A$ we have $d(x,y)<\ep$.
\item A sequence $\{x_n\}$ in $X$ is \textbf{Cauchy} if for every $d$ and $\ep>0$ there is an $N$ such that for any $n,m$, if $n,m>N$ then $d(x_n,x_m)<\ep$.
\item A filter $\F$ in $X$ is \textbf{Cauchy} if for every $d$ and $\ep>0$ there is an $A\in\F$ such that for all $x,y\in A$ we have $d(x,y)<\ep$.
\item $X$ is \textbf{complete} if every Cauchy filter converges to some point.
\end{itemize}

For metric spaces in classical mathematics, it suffices to consider convergent and Cauchy \emph{sequences}.
However, in the gauge and prometric cases we must deal with filters (or nets); and constructively (specifically, in the absence of both excluded middle and countable choice) this is true even for metric spaces.
For instance, the completion of the metric space $\mathbb{Q}$ under limits of Cauchy sequences (the ``Cauchy real numbers'') is potentially much smaller than its full completion under limits of Cauchy filters (the Dedekind real numbers $\R$).
In fact, there may not even be ``enough'' Cauchy filters, so that the completion is properly a non-spatial locale; we will return to this in \cref{sec:completion}.

Note also that the above definitions of Cauchy filter and complete space are only really sensible in the symmetric case.
We will also return to this later.\fxnote{Do that}

In classical mathematics, a metric space is \emph{compact} if and only if it is complete and totally bounded.
Constructively, this is not so; thus one generally either uses ``complete and totally bounded'' as a replacement for ``compact'', or passes to locales instead of spaces (see \cref{sec:locales}).

% Classically, one can \emph{complete} a metric space by equipping a set of equivalence classes of Cauchy sequences with a metric.

We now embark on a process of generalization whose goal is to remove the ``non-topological'' information contained in a prometric, and express the result in an intrinsic way.
In particular, prometric spaces that are topologically isomorphic (by continuous functions), or in some cases uniformly isomorphic (by uniformly continuous functions), ought to give rise to ``topological'' structures that are actually indistinguishable.
In general the way we do this is by considering \emph{relations} between points or subsets rather than distances between them.


\section{Point-point relations: order and apartness}
\label{sec:point-point}
\label{sec:order}

We begin with the simplest, almost trivial, case, of a single relation between pairs of points.
There are two important such ``global'' relations in a prometric space.
As always, $d$ will range over distances in a prometric space $X$.

\begin{defn}\label{def:promet-ord}
  Let $x,y\in X$ be points of a prometric space.
  \begin{itemize}
  \item We say $x\leapx y$ if $\forall d, d(x,y)=0$.\fxwarning{ordering convention?}
  \item We say $x\oapt y$ if $\exists d, d(x,y)>0$.
  \end{itemize}
\end{defn}

Since $\neg(a<b)$ is equivalent to $b\le a$ for located real numbers, in a prometric space we have
\begin{equation}
  (x\leapx y) \iff \neg(x\oapt y).\label{eq:leapx-oapt}
\end{equation}
However, $\oapt$ cannot constructively be expressed in terms of $\leapx$; to say $x\oapt y$ is stronger than $x\neq y$ or even $x\not\leapx y$.

The abstract structure possessed by $\leapx$ is obvious and well-known.

\begin{thm}\label{thm:pmet-preord}
  Let $X$ be a prometric space.
  \begin{enumerate}
  \item The relation $\leapx$ is a \textbf{preorder} (i.e.\ a reflexive transitive relation).
  \item If $X$ is symmetric, then $\leapx$ is a symmetric relation, and hence an \textbf{equivalence relation} (which we will usually write as $\approx$).
  \item $X$ is $T_0$ if and only if $\leapx$ is antisymmetric ($x\leapx y$ and $y\leapx x$ together imply $x=y$), hence a \textbf{partial order}.
  \item $X$ is $T_1$ if and only if $\leapx$ coincides with equality.
  \end{enumerate}
\end{thm}
\begin{proof}
  Reflexivity and transitivity of $\leapx$ follow from reflexivity and transitivity (i.e.\ the triangle inequality) of a prometric, and likewise for symmetry and the separation axioms.
\end{proof}

Of course, $\leapx$ is an instance of the \emph{specialization order} underlying a topology; we will return to this in \cref{sec:point-point}.

The structure possessed by $\oapt$ is less familiar to classical mathematicians, but well-known to constructive ones.  
For reasons that will become clear later, we first define a weaker notion and then the more familiar stronger one.

\begin{defn}\label{def:anti-preorder}
  A \textbf{anti-preorder} is a binary relation $\oapt$ on a set $X$ such that:
  \begin{enumerate}
  \item $\neg(x\oapt x)$ for all $x$ (irreflexivity).
  \item If $x\oapt z$ and $\neg(y\oapt z)$, then $x\oapt y$ (bilocal transitivity).
  \end{enumerate}
  an anti-preorder is\dots
  \begin{enumerate}[resume]
  \item \textbf{bilocally decomposable}, or a \textbf{comparison}, if whenever $x\oapt z$, then for any $y$ we have $x\oapt y$ or $y\oapt z$.
    (Note that this implies bilocal transitivity.)
  \item \textbf{symmetric} if $x\oapt y$ implies $y\oapt x$ (symmetry).
  \item an \textbf{apartness relation} (usually written $\apart$) if it is a symmetric comparison.
  \item \textbf{connected} if $(\neg(x\oapt y)\land \neg(y\oapt x))\implies x=y$.
  \item \textbf{tight} if $\neg(x\oapt y) \implies x=y$.
  \end{enumerate}
\end{defn}

Tightness is usually defined only for symmetric relations, in which case it of course coincides with connectedness.
But in the non-symmetric case, it seems useful to distinguish the two notions.\fxnote{Is this reasonable?}

\begin{warn}
  Some constructive mathematicians write $\neq$ for an arbitrary apartness relation.
  We will always reserve slashed symbols such as $\neq,\not\leapx,\napprox,\notin$ for logical negations (i.e.\ $x\neq y$ means $\neg(x=y)$, $x\not\leapx y$ means $\neg(x\leapx y)$, etc.), and use other symbols such as $\apart$ and $\oapt$ for stronger ``positive'' relations.
\end{warn}

\begin{thm}
  Let $X$ be a prometric space.
  \begin{enumerate}
  \item The relation $\oapt$ is a comparison anti-preorder.  
  \item If $X$ is symmetric, $\oapt$ is an apartness relation.
  \item $X$ is $T_0$ if and only if $\oapt$ is connected.
  \item $X$ is $T_1$ if and only if $\oapt$ is tight.
  \end{enumerate}
\end{thm}
\begin{proof}
  Irreflexivity of $\oapt $ follows directly from reflexivity of a prometric.
  Comparison is rather trickier: if $d(x,z)>0$, we have another distance $d'$ with $d'(x,y)+d'(y,z)\ge d(x,z)$.
  By locatedness of real numbers, $d'(x,y)$ and $d'(y,z)$ are both either $>0$ or $<\frac12 d(x,z)$.
  Thus either $x\oapt y$ or $y\oapt z$ or $d'(x,y)+d'(y,z) < d(x,z)$; but the latter case is a contradiction.

  Symmetry is obvious, and the last two statements follow from~\eqref{eq:leapx-oapt} and \cref{thm:pmet-preord}.
\end{proof}

In particular, the equality relation of a $T_0$ prometric space is (like that of any set with a connected irreflexive relation) \nn-stable, for $\neg\neg(x=y)$ implies $\neg(x\oapt y)$, hence $x\leapx y$ and thus $x=y$.

Preorders and anti-preorders are closely related.
In fact, in classical mathematics they are entirely equivalent notions.
To state the corresponding constructive fact, we first define the appropriate categories.

\begin{defn}
  Let $f:X\to Y$ be a function.
  \begin{enumerate}
  \item If $X$ and $Y$ are preorders, then $f$ is \textbf{monotone} if $x\leapx y \implies f(x)\leapx f(y)$ for all $x,y\in X$.
    We write $\Preord$ for the category of preorders and monotone maps.
  \item If $X$ and $Y$ are anti-preorders, then $f$ is \textbf{monotone}, or \textbf{strongly extensional}, if $f(x)\oapt f(y) \implies x\oapt y$ for all $x,y\in X$.
    We write $\APreord$ for the category of anti-preorders and monotone maps.
  \end{enumerate}
\end{defn}

\begin{thm}\label{thm:ord-le-apt}
  If $X$ is a preorder, then the relation $\neg(x\leapx y)$ is an anti-preorder $\anti(X)$.
  Dually, if $X$ is an anti-preorder, then the relation $\neg(x\oapt y)$ is a preorder $\neigh(X)$.
  These operations define an idempotent adjunction $\anti\adj\neigh$:
  \[\anti : \Preord \rightleftarrows \APreord : \neigh\]
\end{thm}
\begin{proof}
  Reflexivity is easy in both directions.
  If $X$ is a preorder, then for transitivity of its dual, suppose $\neg(x\leapx z)$ and $\neg\neg(y\leapx z)$; we must show $\neg(x\leapx y)$.
  Suppose $x\leapx y$; then since we are trying to prove a contradiction, we may assume $y\leapx z$, hence $x\leapx z$ by transitivity of $\leapx$, contradiction our other assumption.

  Dually, if $X$ is an anti-preorder, for transitivity of its dual suppose $\neg (x\oapt y)$ and $\neg (y\oapt z)$; we must show $\neg(x\oapt z)$.
  Suppose $x\oapt z$; then by transitivity of $\oapt$ and our second assumption we have $x\oapt y$, contradicting our first assumption.

  Functoriality in both directions is obvious from the contravariance of $\neg$.
  For the unit and counit of the adjunction we take identity functions.
  On one hand, if $X$ is a preorder, then $\neigh(\anti(X))$ is the same set $X$ with the relation $\neg\neg(x\leapx y)$.
  Since $(x\leapx y) \implies \neg\neg(x\leapx y)$, the identity function is a monotone map $X\to \neigh(\anti(X))$.
  On the other hand, if $X$ is an anti-preorder, then $\anti(\neigh(X))$ is the same set $X$ with the relation $\neg\neg(x\oapt y)$.
  Since $(x\oapt y) \implies \neg\neg(x\oapt y)$, the identity function is a monotone map $\anti(\neigh(X)) \to X$.
  The triangle identities are obviously satisfied.

  To say that an adjunction is \emph{idempotent} means that the unit or counit (hence also the other) is an isomorphism when restricted to objects in the image of the right or left adjoint, respectively.
  In our case, this follows from the fact that $\neg P \iff \neg\neg\neg P$ for any truth value $P$.
\end{proof}

\cref{thm:ord-le-apt} gives some partial justification for defining the notion of anti-preorder using bilocal transitivity instead of bilocal decomposability (comparison), since there seems no general way to make a comparison by negating a preorder.
Further justification will have to wait for \cref{thm:top-ord} and \cref{sec:syntopogeny}.

Any idempotent adjunction restricts to an equivalence between the full images of the right and left adjoints.
Thus, preorders that are \textbf{\nn-stable} (i.e.\ $\neg\neg(x\leapx y) \implies x\leapx y$) are equivalent to anti-preorders that are \nn-stable.

\begin{thm}\label{thm:pmet-monotone}
  Let $X$ and $Y$ be prometric spaces and $f:X\to Y$ a continuous function.
  Then $f$ is a monotone map of both preorders and anti-preorders.
\end{thm}
\begin{proof}
  For the first, given any $d_Y$ and $\ep>0$ we have a $d_X$ and $\de>0$ such that $d_X(x,y)<\de$ implies $d_Y(f(x),f(y))<\ep$.
  But $d_X(x,y)<\de$ is always true if $x\leapx y$; hence so is $d_Y(f(x),f(y))<\ep$, and thus $f(x)\leapx f(y)$.

  For the second, if $f(x)\oapt f(y)$ we have $d_Y(f(x),f(y))>0$ for some $d_Y$.
  Let $\ep = \frac12 \,d_Y(f(x),f(y))$; then by \cref{thm:cocontinuous} we have a $d_X$ and a $\de>0$ such that if $d_Y(f(x),f(y))>\ep$ (which is true) then $d_X(x,y)>\de$, hence $x\oapt y$.
\end{proof}

In fact,~\eqref{eq:leapx-oapt} means that the preorder of a prometric space is obtained from its anti-preorder via the functor $\neigh$ from \cref{thm:ord-le-apt}, so that the first statement of \cref{thm:pmet-monotone} follows from the second.
This is an instance of the fact that constructively, it is often better to work with anti-preorders (such as apartness relations) than preorders (such as equivalence relations), since many preorders are the dual of some anti-preorder but not conversely.
However, this seems to be due mainly to the impoverished nature of a single binary relation; in later sections we will see that for more refined topological structures we can impose natural conditions (satisfied by any prometric space) to make the ``closeness'' and ``apartness'' notions coincide.

% \begin{thm}\label{thm:ord-topconcrete}
%   The categories of preorders, anti-preorders, and comparison anti-preorders are ``topological over $\Set$'', i.e.\ their forgetful functor to $\Set$ has initial lifts for all sources and (hence) final lifts for all sinks.
%   In particular, they are complete and cocomplete.
% \end{thm}
% \begin{proof}
%   Given a source $\{f_i : X \to Y_i\}$ with each $Y_i$ a preorder, define $x\leapx y$ for $x,y\in X$ to mean that $f_i(x)\leapx_i f_i(y)$ for all $i$.
%   This is evidently a preorder and the initial lift.

%   Similarly, given $\{f_i : X \to Y_i\}$ with each $Y_i$ an anti-preorder, define $x\oapt y$ for $x,y\in X$ to mean that $f_i(x)\oapt_i f_i(y)$ for \emph{some} $i$.
%   Irreflexivity is obvious.
%   For bilocal transitivity, if $x\oapt z$, so that $f_i(x)\oapt_i f_i(z)$ for some $i$, then if $\neg(y\oapt z)$ we have $\neg (f_i(y)\oapt_i f_i(z))$, hence $f_i(x) \oapt_i f_i(y)$ and so $x\oapt y$.
%   A similar argument works for comparison.
% \end{proof}


\section{Point-set relations: topology}
\label{sec:point-set}
\label{sec:topology}

The specialization order and the apartness relation, while important, do not usually capture very much of the topological information in a prometric space.
The crucial step that brings us into the world of general topology is to consider relations involving \emph{sets} as well as points.
There are three fundamental relations between a point and a set that can be defined in a prometric space $X$ (with $d$ ranging over distances and $\ep$ over positive reals, as always):

\begin{defn}\label{defn:toprels}
  Let $X$ be a prometric space, $x\in X$, and $A\subseteq X$.
  \begin{enumerate}
  \item $x\ll A$ if $\exists d, \exists \ep, \forall y, (d(x,y)<\ep \implies y\in A)$ ($A$ is a \textbf{neighborhood} of $x$).
  \item $x\bowtie A$ if $\exists d, \exists \ep, \forall y, (y\in A \implies d(x,y)>\ep)$ ($x$ is \textbf{apart} from $A$).
  \item $x\approx A$ if $\forall d, \forall \ep, \exists y, (y\in A \land d(x,y)<\ep)$ ($x$ is \textbf{close} to $A$).
  \end{enumerate}
\end{defn}

We can now axiomatize the basic properties of these relations.
Our treatment is strongly inspired by that of~\cite{bridges-vita}, but we make some minor choices differently, in order to obtain better category-theoretic properties and also to fit better into the general framework we will articulate later.
In \cref{sec:top-compare} we will compare our definitions to theirs.


\subsection{Neighborhood, apartness, and closure spaces}
\label{sec:top}

In contrast to \cref{sec:point-point}, here we will also consider structures that lack transitivity.
We write $\cpl{A} = X\setminus A = \setof{x\in X | x\notin A}$ for the relative complement of a subset $A\subseteq X$.

\begin{defn}
  A \textbf{pretopological neighborhood space} is a set $X$ with a relation $\ll$ between points and subsets such that
  \begin{enumerate}
  \item If $x\ll A$ and $A\subseteq B$, then $x\ll B$ (isotony).
  \item If $x\ll A$, then $x\in A$ (reflexivity).
  \item $x\ll X$ for all $x\in X$ (nullary additivity).
  \item If $x\ll A$ and $x\ll B$, then $x\ll A\cap B$ (binary additivity).
  \end{enumerate}
  A pretopological neighborhood $X$ space is\dots
  \begin{enumerate}[resume]
  \item \textbf{topological} if whenever $x\ll A$, we have $x \ll \setof{ y | y\ll A}$ (transitivity).
  % \item \textbf{\nn-stable} if whenever $x\ll A$, there is a subset $B$ such that $x\ll \cpl{B} \subseteq A$.
  \item \textbf{locally decomposable} if whenever $x\ll A$, there is a subset $B$ such that $x\ll B$ and $\forall y, (y\notin B \lor y \ll A)$.
  \end{enumerate}
  If $X$ and $Y$ are pretopological neighborhood spaces, a function $f:X\to Y$ is \textbf{continuous} if $f(x)\ll A$ implies $x\ll f\inv(A)$.
  We write $\PTop$ for the category of pretopological neighborhood spaces and continuous maps, and $\Top$
  % $\PTopnn$,
  and $\ldTop$ for its subcategories of topological %, \nn-stable,
  and locally decomposable neighborhood spaces.
\end{defn}

Note that a locally decomposable neighborhood space is automatically topological, % and \nn-stable,
since if $\forall y, (y\notin B \lor y \ll A)$ then % $\neg\neg B \subseteq A$ and also
$B \subseteq \setof{ y | y\ll A}$.
Conversely, in classical mathematics any topological neighborhood space is locally decomposable, since we can take $B = \setof{ y | y\ll A}$.
So the distinction between the two is only visible in the constructive world.

\begin{defn}
  A \textbf{pretopological apartness space} (sometimes a \textbf{point-set apartness space} for emphasis) is a set $X$ with a relation $\bowtie$ between points and subsets such that
  \begin{enumerate}
  \item If $x\bowtie A$ and $B\subseteq A$, then $x\bowtie B$ (isotony).
  \item If $x\bowtie A$, then $x\notin A$ (reflexivity).
  \item $x\bowtie \emptyset$ for all $x\in X$ (nullary additivity).
  \item If $x\bowtie A$ and $x\bowtie B$, then $x\bowtie A\cup B$ (binary additivity).
  \end{enumerate}
  A pretopological apartness space is\dots
  \begin{enumerate}[resume]
  \item \textbf{topological} if whenever $x\bowtie A$, we have $x\bowtie \setof{ y | y \not\bowtie A }$ (transitivity).
  % \item \textbf{\nn-stable} if whenever $x\bowtie A$, we have $x\bowtie \cpl{\cpl{A}}$.
  \item \textbf{locally decomposable} if whenever $x\bowtie A$, there is a subset $B$ such that $x\bowtie B$ and $\forall y, (y\in B \lor y\bowtie A)$.
  \end{enumerate}
  If $X$ and $Y$ are pretopological apartness space, a function $f:X\to Y$ is \textbf{continuous} if $f(x)\bowtie f(A)$ implies $x\bowtie A$.
  We write $\APTop$ for the category of pretopological apartness spaces and continuous maps, and $\ATop$
  % , $\APTopnn$,
  and $\ldATop$ for its subcategories of topological %, \nn-stable,
  and locally decomposable apartness spaces.
\end{defn}

As before, a locally decomposable pretopological apartness space is topological, since if $\forall y, (y\in B \lor y\bowtie A)$ then $\setof{ y | y \not\bowtie A } \subseteq B$.
% Moreover, in slight contrast to the neighborhood case, any topological apartness space is \nn-stable, since $\cpl{\cpl{A}}\subseteq \setof{ y | y \not\bowtie A }$ by the contrapositive of reflexivity.
Similarly, in classical mathematics any topological apartness space is locally decomposable, since we can take $B = \setof{y|y\not\bowtie A}$.

As we will see below, the relation $\approx$ is not very useful to axiomatize constructively, so we will not bother to isolate its constructive variants.
We will however name the version that omits binary additivity, since that axiom is usually impossible to achieve constructively.

\begin{defn}
  A \textbf{Moore closure space} is a set $X$ with a relation $\approx$ between points and subsets such that
  \begin{enumerate}
  \item If $x\approx A$ and $A\subseteq B$, then $x\approx B$ (isotony).
  \item If $x\in A$, then $x\approx A$ (reflexivity).
  \item $x\napprox \emptyset$ for all $x\in X$ (nullary additivity).
  \item If $x\approx \setof{ y | y\approx A}$, then $x\approx A$ (transitivity).
  \end{enumerate}
  A Moore closure space is \textbf{topological} if it also satisfies
  \begin{enumerate}[resume]
  \item If $x\approx A\cup B$, then $x\approx A$ or $x\approx B$ (binary additivity).
  \end{enumerate}
  If $X$ and $Y$ are topological or Moore closure spaces, a function $f:X\to Y$ is \textbf{continuous} if $x\approx A$ implies $f(x) \approx f(A)$.
\end{defn}

A relation between points and subsets can equivalently be defined in terms of an operation taking each subset to the subset of points related to it.
For instance, in a topological neighborhood space, the \textbf{interior} of a set $A$ is
\[ \int(A) = \setof{ x | x\ll A } \]
The axioms of $\ll$ say exactly that $\int(-)$ is a left-exact comonad on the powerset of $X$.
Hence it is determined by its fixed points, which are called \textbf{open sets}, and are closed under arbitrary unions and finite intersections.
This is, of course, the usual definition of a \textbf{topological space}.
We will stick to working directly with $\ll$, however, since it is more analogous to $\bowtie$ and generalizes better.
Our ``pretopological neighborhood spaces'' also coincide with the usual classical definition of \emph{pretopological space}, usually defined as a set equipped with a filter of neighborhoods at each point.

Similarly, in a Moore closure space, the \textbf{closure} of a set $A$ is
\[ \cl(A) = \setof{x | x \approx A } \]
The axioms of $\approx$ say exactly that $\cl(-)$ is a comonad on the powerset of $X$, which is right-exact exactly when $X$ is topological.
Hence it is determined by its fixed points, which are called \textbf{closed sets}, and are closed under arbitrary intersections (and finite unions, if $X$ is topological).

Finally, in a pretopological apartness space, the \textbf{exterior} of a set $A$ is
\[ \ext(A) = \setof{ x | x\bowtie A } \]
It is less natural to rephrase the axioms of $\bowtie$ in terms of $\ext$, however.

\begin{thm}\label{thm:pmet-top}
  If $X$ is a prometric space, then the relations $\ll$, $\bowtie$, and $\approx$ from \cref{defn:toprels} make it into a locally decomposable topological neighborhood space, a locally decomposable topological apartness space, and a Moore closure space, plus a topological closure space if excluded middle holds.
\end{thm}
\begin{proof}
  In all cases, isotony and nullary additivity are obvious, while reflexivity follows directly from prometric reflexivity ($d(x,x)=0$).
  Binary additivity for $\ll$ and $\bowtie$ follow directly from the definitions of $\cap$ and $\cup$.

  Binary additivity for $\approx$, however, requires that if $\forall d,\forall \ep, \exists y\in A\cup B, d(x,y)<\ep$, then either $\forall d,\forall \ep, \exists y\in A, d(x,y)<\ep$ or $\forall d,\forall \ep, \exists y\in B, d(x,y)<\ep$.
  If excluded middle holds, we can prove this by contradiction: if neither of the two desired conclusions holds, then there are $d_1,\ep_1$ such that $d_1(x,y)\ge \ep_1$ for all $y\in A$, and also $d_2,\ep_2$ such that $d_2(x,y)\ge\ep_2$ for all $y\in B$.
  Then by binary filtration, there is a $d_3$ such that $d_1\le d_3$ and $d_2\le d_3$, and by assumption there is a $y\in A\cup B$ such that $d_3(x,y)<\min(\ep_1,\ep_2)$.
  But our assumptions show that this $y$ cannot be in $A$ or in $B$, a contradiction.
  Constructively, however, it seems impossible to prove this axiom.

  For local decomposability of $\ll$, if $x\ll A$ then we have a $d,\ep$ with $d(x,y)<\ep \implies y\in A$.
  Let $d'$ be as in prometric transitivity for $d$, and $B = \setof{ y | d'(x,y) < \fep13}$.
  Then certainly $x\ll B$, while for any $y$ we have either $d'(x,y)<\fep23$ or $d'(x,y)>\fep13$.
  In the first case, if $d'(x,y)<\fep23$, then for any $z$ with $d'(y,z)<\fep13$ we have $d(x,z) \le d'(x,y)+d'(y,z) <\ep$, so $z\in A$; thus $y\ll A$.
  In the second case, if $d'(x,y)>\fep13$ then certainly $y\notin B$.
  Local decomposability of $\bowtie$, and transitivity of $\approx$, are similar.
\end{proof}

In classical mathematics, all three notions of topological space are equivalent, via the following definitions:
\[
\begin{array}{ccccc}
  x\ll A & \iff & x \bowtie \cpl{A} & \iff & x\napprox \cpl{A}\\
  x\bowtie A & \iff & x\napprox A & \iff & x \ll \cpl{A}\\
  x\approx A & \iff & x \not\ll \cpl{A} & \iff & x \not\bowtie A
\end{array}
\]
Constructively, this is no longer so, but we do have various relationships between the three structures.
Closure spaces are unsatisfactory as a \emph{basic} notion of space because their binary additivity axiom cannot be proven even for metric spaces, but the following notions are nevertheless useful:

\begin{thm}\label{thm:top-closed}
  Let $X$ be a topological neighborhood space.
  \begin{enumerate}
  \item If we define $x\approx A$ to mean
    \[\forall B, (x\ll B \implies A\cap B \text{ is inhabited}),\]
    then $X$ becomes a Moore closure space.\label{item:top-ll-wkcl}
    Its closed sets are called \textbf{weakly closed} in $X$.
  \item If we define $x\approx A$ to mean
    \[\forall B, (x\ll B \implies A\cap B \neq \emptyset),\]
    then $X$ becomes a Moore closure space.\label{item:top-ll-strcl}
    Its closed sets are called \textbf{strongly closed} in $X$ (they are the complements of the open sets).
  \end{enumerate}
  Moreover, both these constructions are functorial.
\end{thm}
\begin{proof}
  In both cases, all the axioms are easy except binary additivity and transitivity.
  Binary additivity fails constructively for essentially the same reason that it failed for prometric spaces.

  For transitivity of~\ref{item:top-ll-wkcl}, if $x\approx \setof{y | y\approx A}$, then whenever $x\ll B$, we also have $x\ll \int(B)$ by transitivity for $\ll$.
  Hence there is a $y\in \int(B)$ such that $y\approx A$; but then $y\ll \int(B)$, and so by definition of $\approx$ there is a $z\in\int(B)$ with $z\in A$.
  Since then $z\in B$ too, we have $x\approx A$.

  For transitivity of~\ref{item:top-ll-strcl}, let $x\approx \setof{y | y\approx A}$ and suppose for contraction that $x\ll B$ and $A\cap B =\emptyset$.
  Then also $x\ll \int(B)$ and $A\cap \int(B)=\emptyset$.
  We will show that $\setof{y | y\approx A} \cap \int(B) = \emptyset$, for which purpose suppose it contains an element $y$.
  But then $y\approx A$ and $y\in \int(B)$, hence $y\ll \int(B)$; thus by definition of $\approx$ we have $A\cap \int(B) \neq \emptyset$, a contradiction.

  For functoriality, suppose $X$ and $Y$ are topological neighborhood spaces and $f:X\to Y$ is $\ll$-continuous.
  If $x\approx A$ weakly, suppose given $B\subseteq Y$ with $f(x)\ll B$; then by $\ll$-continuity, we have $x\ll f\inv(B)$.
  Since $x\approx A$, we have $A\cap f\inv(B)$ inhabited, hence $f(A) \cap B$ inhabited.
  Thus, $f(x)\approx f(A)$.
  The proof for strong $\approx$ is essentially the same.
\end{proof}

In~\cite{bridges-vita} the weak closure relation $x\approx A$ is written as $\mathbf{near}(x,A)$, and an example is given showing that binary additivity for this relation in the metric space $\R$ implies the Limited Principle of Omniscience.
We will not say much more about closure spaces.

Topological neighborhood spaces and topological apartness spaces, on the other hand, are both reasonable constructive notions of ``space''.
In support of this we note the following:

\begin{thm}\label{thm:top-topconcrete}
  The categories $\PTop$ and $\APTop$ are ``topological over $\Set$'', i.e.\ their forgetful functor to $\Set$ has initial lifts for all sources and (hence) final lifts for all sinks.
  In particular:
  \begin{enumerate}
  \item They are complete and cocomplete.
  \item Induced and coinduced structures exist.
  \item The forgetful functor to $\Set$ has both a left adjoint (discrete spaces) and a right adjoint (indiscrete spaces).
  \item Every continuous function factors uniquely as a surjection followed by an embedding (an inclusion with the induced structure), and also as a quotient (a surjection with the coinduced structure) followed by an injection.
  \end{enumerate}
  Moreover, their subcategories $\Top$, $\ATop$, %$\PTopnn$,
  $\ldTop$, and $\ldATop$ % (but not $\APTopnn$)
  are closed under initial lifts for sources.
  In particular, they are each also topological over $\Set$, and are reflective in the corresponding supercategory.
\end{thm}
\begin{proof}
  Note that pretopological neighborhood and apartness relations are closed under directed unions of point-set relations.
  Directedness is necessary for preservation of additivity.
  However, any family of such relations still has a join in the poset of such relations, constructed explicitly by closing up under finite additivity.
  Moreover, such joins preserve transitivity %, \nn-stability in the neighborhood case,
  and local decomposability.

  Explicitly, given a family $\{\ll_i\}$ of pretopological neighborhood relations, define $x\ll A$ to mean that there exists a finite family $i_1,\dots,i_n$ and sets $B_1,\dots, B_n$ such that $\bigcap_{j=1}^n B_j \subseteq A$ and $x\ll_{i_j} B_j$ for all $j$.
  This satisfies isotony and additivity essentially by construction, and satisfies reflexivity since all the $\ll_i$ do.

  If moreover each $\ll_i$ is topological, then $x\ll_{i_j} \setof{y|y\ll_{i_j} B_j}$ by transitivity for $\ll_{i_j}$, while $\bigcap_{j=1}^n \setof{y|y\ll_{i_j} B_j} \subseteq \setof{y|y\ll A}$ essentially by the above definition of $\ll$; thus $x\ll \setof{y|y\ll A}$.
  %If instead each $\ll_i$ is \nn-stable, then we have $C_j$ with $x\ll_{i_j} \cpl{C_j}\subseteq B_j$; then if $C = \bigcup_{j=1}^n C_j$ we have $\bigcap_{j=1}^n \cpl{C_j} = \cpl{C}$, so $x\ll \cpl{C} \subseteq A$.
  Finally, if each $\ll_i$ is locally decomposable, we have $C_j$ such that $x\ll_{i_j} C_j$ and $\forall y, (y\notin C_j \lor y\ll_{i_j} B_j)$.
  Then $x \ll \bigcap_{j=1}^n C_j$, while any $y$ must either be in all the $B_j$ (hence in $A$) or not in some $C_j$ (hence not in $\bigcap_{j=1}^n C_j$).
  Thus $\bigcap_{j=1}^n C_j$ exhibits local decomposability of $\ll$.

  The argument for apartness is similar: define $x\bowtie A$ to mean that there exist $i_1,\dots,i_n$ and $B_1,\dots, B_n$ such that $A\subseteq \bigcup_{j=1}^n B_j$ and $x\bowtie_{i_j} B_j$ for all $j$.
  Isotony, additivity, and reflexivity are again obvious.
  If each $\bowtie_i$ is topological, then have $x\bowtie_{i_j} \setof{y|y\not\bowtie_{i_j} B_j}$, while $\setof{y|y\not\bowtie A} \subseteq \bigcup_{j=1}^n\setof{y|y\not\bowtie_{i_j} B_j}$ by construction, so $x\bowtie \setof{y|y\not\bowtie A}$.
  If instead all the $\bowtie_i$ are locally decomposable, we then have $C_j$ such that $x\bowtie_{i_j} C_j$ and $\forall y, (y\in C_j \lor y\bowtie_{i_j} B_j)$.
  Then $x\bowtie \bigcup_{j=1}^n C_j$, while any $y$ must be either in some $C_j$ (hence in $\bigcup_{j=1}^n C_j$) or satisfy $y\bowtie_{i_j} B_j$ for all $j$, hence $y\bowtie A$.
  %(If each $\bowtie_i$ is \nn-stable, then $x\bowtie_{i_j} \cpl{\cpl{B_j}}$, but we cannot say that $\cpl{\cpl{A}} \subseteq \bigcup_{j=1}^n \cpl{\cpl{B_j}}$, only $\cpl{\cpl{A}} \subseteq \cpl{\cpl{\bigcup_{j=1}^n B_j}}$.)

  Next, if $(Y,\ll_Y)$ is a pretopological neighborhood space and $f:X\to Y$ is any function, define $x\ll_f A$ to mean that $f\inv(B)\subseteq A$ for some $B$ such that $f(x)\ll_Y B$.
  This is a pretopological neighborhood relation on $X$: isotony is by construction, reflexivity is obvious, and additivity follows since $f\inv$ preserves intersections.
  If $\ll_Y$ is topological and $x\ll_f A$, so that $f(x)\ll_Y B$ and $f\inv(B)\subseteq A$, then $f(x)\ll_Y \setof{y|y\ll_Y B}$; but $f\inv(\setof{y|y\ll_Y B}) \subseteq \setof{z|z\ll_f A}$ essentially by definition of $\ll_f$, so $x \ll_f \setof{z|z\ll_f A}$.
  %If instead $\ll_Y$ is \nn-stable, then $f(x)\ll_Y \cpl{C} \subseteq B$, whence $x \ll_f \cpl{f\inv(C)}$ and $\cpl{f\inv(C)} = f\inv(\cpl{C}) \subseteq f\inv(B) \subseteq A$.
  Finally, if $\ll_Y$ is locally decomposable and, we have a $C$ with $f(x)\ll C$ and $\forall y, (y\notin C \lor y\ll B)$; but then $x\ll_f f\inv(C)$ and $\forall z, (f(z)\notin C \lor f(z) \ll B)$, hence $\forall z, (z\notin f\inv(C) \lor z \ll_f A)$.

  Moreover, $f$ is continuous for some pretopological neighborhood relation $\ll_X$ on $X$ if and only $\ll_f$ is contained in $\ll_X$.
  More generally, for any pretopological neighborhood space $(Z,\ll_Z)$ and function $g:Z\to X$, the composite $f g$ is continuous if and only if $\ll_{f g}$ (which coincides with $(\ll_f)_g$) is contained in $\ll_Z$.
  Thus, any source $\{ f_i : X \to Y_i \}$, where each $Y_i$ is a pretopological neighborhood space, has an initial lift, consisting of the join of all the $\ll_{f_i}$ constructed as above; and if each $Y_i$ is topological %, \nn-stable,
  or locally decomposable, so is the resulting structure on $X$.

  The argument for apartness is analogous, using the relation $x\bowtie_f A$ defined to mean $f(x)\bowtie_Y f(A)$.
  This is a pretopological apartness relation on $X$: reflexivity is obvious, while isotony and additivity follow since direct images of subsets preserve containment and unions.
  If $\bowtie_Y$ is topological and $x\bowtie_f A$, so that $f(x)\bowtie_Y f(A)$, then $f(x) \ll_Y \setof{y|y\not\bowtie_Y f(A)}$; but $f(\setof{z|z\not\bowtie_f A}) \subseteq \setof{y|y\not\bowtie_Y f(A)}$ essentially by definition of $\bowtie_f$, so $x\bowtie_f \setof{z|z\not\bowtie_f A}$.
  If instead $\bowtie_Y$ is locally decomposable, we have a $B$ with $f(x)\bowtie B$ and $\forall y,(y\in B \lor y\bowtie f(A))$.
  Thus $\forall z, (f(z)\in B \lor f(z)\bowtie f(A))$, hence $\forall z, (z\in f\inv(B) \lor z\bowtie_f A)$, while $f(x) \bowtie f(f\inv(B))$ by isotony and thus $x \bowtie_f f\inv(B)$.
  % (Note that this construction does also work for \nn-stability, so that $\APTopnn$ is at least a fibration over $\Set$.)

  Again $f$ is continuous for $\bowtie_X$ iff $\bowtie_f$ is contained in $\bowtie_X$, and similarly for $f g$.
  Thus to construct an initial lift we can join all the $\bowtie_{f_i}$, which is topological or locally decomposable if all the $Y_i$ are.
\end{proof}

Note that an analogous argument for closure spaces \emph{doesn't} work.
This is another reason closure spaces are unsatisfactory.
The close similarity between the proofs for $\bowtie$ and $\ll$ is one reason we have chosen to work with $\ll$ rather than open sets.

For the relationship between neighborhood and apartness spaces, we have the following analogue of \cref{thm:ord-le-apt}:

\begin{thm}\label{thm:top-ll-bowtie}
  If $X$ is a pretopological neighborhood space, define $x\bowtie A$ to mean $x\ll \cpl{A}$; this is a pretopological apartness space $\anti(X)$.
  Dually, if $X$ is a pretopological apartness space, define $x\ll A$ to mean that there exists a $B$ such that $x\bowtie B$ and $\cpl{B}\subseteq A$; this is a pretopological neighborhood space $\neigh(X)$.
  These operations define an idempotent adjunction $\anti\adj \neigh$:
  \[ \anti : \PTop \rightleftarrows \APTop : \neigh. \]
  Moreover:
  \begin{enumerate}
  \item Like any idempotent adjunction, it restricts to an equivalence between the fixed objects on each side.
    A pretopological neighborhood space is fixed if and only if whenever $x\ll A$, there is a subset $B$ such that $x\ll \cpl{B} \subseteq A$.
    A pretopological apartness space is fixed if and only if whenever $x\bowtie A$, we have $x\bowtie \cpl{\cpl{A}}$.
    We call these objects \textbf{\nn-stable}.
  \item If $X$ is a topological neighborhood space, then $\anti(X)$ is a topological apartness space.
  \item If $X$ is a topological apartness space, then it is \nn-stable and hence a fixed point of the adjunction.
  \item Both functors $\anti$ and $\neigh$ preserve local decomposability, and locally decomposable spaces are \nn-stable.
    Thus the adjunction restricts to an equivalence $\ldTop \simeq \ldATop$.
    \label{item:top-ll-bowtie-equiv}
  \end{enumerate}
\end{thm}
\begin{proof}
  In both cases the preservation of isotony, reflexivity, and additivity is easy.
  There are no worries about de Morgan's law, because in \emph{both} cases the set we are complementing is the one apart from something, binary additivity for apartness involves unions, and $\cpl{(A\cup B)} = \cpl{A} \cap \cpl{B}$ is the de Morgan law that does hold constructively.

  For functoriality of $\anti$, suppose $f:X\to Y$ is a continuous map of pretopological neighborhood spaces, and that $f(x) \bowtie f(A)$, meaning by definition $f(x)\ll \cpl{f(A)}$.
  Then by continuity of $f$ we have $x \ll f\inv(\cpl{f(A)}) = \cpl{f\inv(f(A))}$, hence $x\bowtie f\inv(f(A))$ by definition.
  But $A \subseteq f\inv(f(A))$, so $x\bowtie A$ by isotony.
  Thus $\anti(f)$ is continuous.

  For functoriality of $\neigh$, suppose $f:X\to Y$ is a continuous map of pretopological apartness spaces, and that $f(x) \ll A$, meaning that $f(x) \bowtie B$ and $\cpl{B} \subseteq A$ for some $B$.
  Then $f(x) \bowtie f(f\inv(B))$ by isotony, so $x\bowtie f\inv(B)$ by continuity of $f$, while $\cpl{f\inv(B)} = f\inv(\cpl{B}) \subseteq f\inv(A)$; so $x\ll f\inv(A)$ by definition.
  Thus $\neigh(f)$ is continuous.

  As in \cref{thm:ord-le-apt}, the unit and counit are the identity functions, so that the triangle identities are trivial once we know that the unit and counit are continuous.
  If $X$ is a pretopological neighborhood space, then in $\neigh(\anti(X))$ to say ``$x\ll A$'' means that there is a $B$ such that $\cpl{B}\subseteq A$ and $x\ll \cpl{B}$.
  This implies $x\ll A$ in $X$ by isotony, so the identity function $X\to \neigh(\anti(X))$ is continuous; and it is an isomorphism exactly when $X$ is \nn-stable as defined above.
  
  On the other side, if $X$ is a pretopological apartness space, then in $\anti(\neigh(X))$ to say ``$x\bowtie A$'' means that $x\bowtie B$ and $\cpl{B}\subseteq \cpl{A}$ for some $B$.
  This is implied by $x\bowtie A$ in $X$ (take $B=A$), so the identity function $\anti(\neigh(X)) \to X$ is continuous.
  To see that it is an isomorphism exactly when $X$ is \nn-stable as defined above, note that $\cpl{B}\subseteq \cpl{A}$ is equivalent to $A \subseteq \cpl{\cpl{B}}$.

  For idempotence, it suffices to show that $\anti(X)$ and $\neigh(X)$ are both \nn-stable.
  In the former case this follows from the identity $\cpl{\cpl{\cpl{A}}} = \cpl{A}$, and in the latter essentially by definition.

  To see that $\anti$ preserves transitivity, suppose $x\bowtie A$ in $\anti(X)$, i.e.\ $x\ll \cpl{A}$.
  To show $x\bowtie \setof{y|\neg(y\bowtie A)}$ means to show $x\ll \setof{y|\neg\neg(y\bowtie A)} = \setof{y|\neg\neg(y\ll \cpl{A})}$.
  But $x\ll \setof{y|y\ll \cpl{A}}$ by transitivity for $\ll$, and $(y\ll \cpl{A})\implies\neg\neg(y\ll\cpl{A})$, so the result follows by isotony.

  A locally decomposable neighborhood space is \nn-stable since if $\forall y, (y\notin B \lor y \ll A)$ then $\neg\neg B \subseteq A$.
  Similarly, a topological apartness space is \nn-stable, since $\cpl{\cpl{A}}\subseteq \setof{ y | y \not\bowtie A }$ by the contrapositive of reflexivity.
  Thus, it remains to show that $\anti$ and $\neigh$ both preserve local decomposability.

  Suppose first that $X$ is a locally decomposable neighborhood space, and $x \bowtie A$ in $\anti(X)$, so that $x\ll \cpl{A}$.
  Then we have a $B$ with $x\ll B$ and $\forall y, (y\notin B \lor y\ll \cpl{A})$.
  Let $C = \cpl{B}$; then $x\ll \cpl{C}$ by isotony, i.e.\ $x\bowtie C$.
  Moreover, for any $y$ we have either $y\ll\cpl{A}$, hence $y\bowtie A$, or $y\notin B$, hence $y\in C$.
  Thus, $\anti(X)$ is locally decomposable.

  In the other direction, suppose $X$ is a locally decomposable apartness space, and $x\ll A$ in $\neigh(X)$, so that $x\bowtie B$ and $\cpl{B}\subseteq A$.
  Then we have a $C$ with $x\bowtie C$ and $\forall y, (y\in C \lor y\bowtie B)$.
  Let $D = \cpl{C}$; then $x\ll D$ since $x\bowtie C$.
  Moreover, for any $y$ we have either $y\in C$, hence $y\notin D$, or $y\bowtie B$, hence $y\ll A$.
  Thus, $\neigh(X)$ is locally decomposable.
\end{proof}

\begin{rmk}
  In particular, it follows that \nn-stable pretopological neighborhood spaces are a reflective subcategory of $\PTop$, while \nn-stable pretopological apartness spaces are a coreflective subcategory of $\APTop$.
  In particular, both are complete and cocomplete, and indeed topological over $\Set$.
  % \cref{thm:top-ll-bowtie} explains why \cref{thm:top-topconcrete} does not include $\APTopnn$: rather than being reflective in $\APTop$, the category $\APTopnn$ is \emph{coreflective} therein.
  % This implies that it is also topological over $\Set$ in its own right, though it is not closed under initial lifts in $\APTop$.
\end{rmk}

Recall that in \cref{thm:pmet-top} we showed that a prometric space has both a locally decomposable neighborhood relation and a locally decomposable apartness.

\begin{thm}\label{thm:promet-top}
  The $\bowtie$ and $\ll$ underlying any prometric space are identified with each other by the equivalence of \cref{thm:top-ll-bowtie}\ref{item:top-ll-bowtie-equiv}.
  Moreover, this defines a fully faithful functor from prometric spaces and continuous functions to $\ldTop$ (or equivalently $\ldATop$).
\end{thm}
\begin{proof}
  Let $X$ be a prometric space; we first show that $x\bowtie A$ if and only if $x\ll \cpl{A}$ according to \cref{defn:toprels}, so that the two structures are identified by $\anti$.
  If $x\bowtie A$, we have $d,\ep$ such that $y\in A \implies d(x,y)>\ep$ for any $y$.
  By a contrapositive, it follows that $d(x,y)\le \ep \implies y\notin A$, giving $x\ll \cpl{A}$.
  Conversely, if $x\ll\cpl{A}$, we have $d,\ep$ such that $d(x,y)< \ep \implies y\notin A$ for any $y$.
  The contrapositive is now $\neg\neg(y\in A) \implies d(x,y)\ge \ep$, which implies $y\in A \implies d(x,y)> \hfep$, so $x\bowtie A$.

  Now let $X$ and $Y$ be prometric spaces and $f:X\to Y$ a function.
  Suppose first that $f$ is prometrically continuous, and let $f(x)\ll A$, so that we have $d_Y,\ep$ with $d_Y(f(x),y)< \ep \implies y\in A$ for any $y\in Y$.
  By continuity, there is a $d_X$ and a $\de$ such that $d_X(x,x')<\de \implies d_Y(f(x),f(x'))<\ep$ for any $x'\in X$, and hence $d_X(x,x')<\de \implies x'\in f\inv(A)$.
  Thus $x\ll f\inv(A)$, so $f$ is $\ll$-continuous.

  On the other hand, if $f$ is $\ll$-continuous, for any $x$ and any $d_Y,\ep$ we have $f(x)\ll \setof{y|d_Y(f(x),y)<\ep}$.
  Thus $x\ll \setof{x'|d_Y(f(x),f(x'))<\ep}$, which means (by definition of $\ll$) we have $d_X,\de$ such that $d_X(x,x')<\de \implies d_Y(f(x),f(x'))<\ep$, giving prometric continuity.
\end{proof}

Thus, both locally decomposable neighborhood spaces and locally decomposable apartness spaces suffice to capture the topological information in a prometric space.
Subsequently we may simply speak of a \textbf{locally decomposable topological space}, which comes with both a $\ll$ and a $\bowtie$ that are interdefinable.

\begin{rmk}
  \cref{thm:top-topconcrete} implies that the forgetful functor from locally decomposable spaces to sets has a left adjoint, assigning to every set the finest possible locally decomposable topology on that set.
  This is \emph{not} generally the discrete topology, since a discrete topology (meaning $x\ll A$ iff $x\in A$) is locally decomposable if and only if equality on $X$ is decidable.
  Of course we cannot expect to prove that this topology is non-discrete in any particular case, since excluded middle implies that it is.
  But it seems likely that in many interesting cases it will turn out metatheoretically to coincide with the ``natural'' topology.
\end{rmk}


\subsection{Separation axioms}
\label{sec:separation}

However, prometric spaces (especially symmetric ones and gauge spaces) are still very special objects of $\ldTop$, and much of their specialness is captured by additional \emph{separation axioms}.
(Local decomposability itself is also naturally regarded as a separation axiom, albeit one that is only nontrivial constructively.
This will be clearer in later sections, when its close relationship with regularity becomes evident.)

We will not exhaustively survey separation axioms, but there are a few others worth mentioning.
The first few are naturally phrased using the fact that point-set relations give rise to point-point relations.

%TODO: Left adjoints
% giving a left adjoint to the functor taking a topological neighborhood space to its underlying $\leapx$.
%This likewise gives a left adjoint to the functor taking a pretopological apartness relation to its underlying $\oapt$ (which is only irreflexive in the pretopological case), and 

\begin{thm}\label{thm:top-ord}\ 
  \begin{enumerate}
  \item If $X$ is a topological neighborhood space, define $x\leapx y$ to mean that $\forall A, (x\ll A \to y\ll A)$.
    Then $\leapx$ is a preorder, called the \textbf{specialization order} of $X$.
  \item If $X$ is a topological apartness space, define $x\oapt y$ to mean $x \bowtie \singleton{y}$.
    Then $\oapt$ is an anti-preorder, called the \textbf{specialization anti-preorder} of $X$.
    If $X$ is locally decomposable, then $\oapt$ is a comparison.
  \end{enumerate}
  Moreover, if $X$ is a prometric space then both of these relations agree with those defined in \cref{def:promet-ord}.
\end{thm}
\begin{proof}
  In the neighborhood case, reflexivity and transitivity of $\leapx$ follow directly from reflexivity and transitivity of $\implies$.
  If $X$ is a prometric space and $\forall d, d(x,y)=0$, then whenever $x\ll A$ we have $d,\ep$ with $d(x,z)<\ep \implies z\in A$ for any $z$.
  Let $d'$ be as in prometric transitivity for $d$; then $d'(x,y)=0$, so if $d'(y,z)<\ep$ we have $d(x,z)<\ep$, hence $z\in A$.
  Thus $d',\ep$ exhibit $y\ll A$.

  Conversely, if $\forall A, (x\ll A \implies y\ll A)$, then for any $d,\ep$ let $A = \setof{z|d(x,z)<\ep}$.
  Then $x\ll A$, so $y\ll A$, and in particular $y\in A$, so $d(x,y)<\ep$.
  Since this is true for all $\ep$, we have $d(x,y)=0$ for all $d$.

  In the apartness case, irreflexivity is obvious.
  For bilocal transitivity, if $x\oapt z$ so that $x\bowtie \singleton{z}$, then by transitivity for $\bowtie$ we have $x \bowtie \setof{y|y\not \bowtie \singleton{z}}$.
  Thus, if $\neg (y\oapt z)$, so that $\neg (y\bowtie \singleton{z})$, then $y$ belongs to a set that is apart from $x$; hence $x\bowtie \singleton{y}$ by isotony, i.e.\ $x\oapt y$.

  For the comparison axiom, we note first that local decomposability implies the following property that we call \textbf{weak local decomposability}: if $x\bowtie A$, then $\forall y, (x\bowtie \singleton{y} \lor y\bowtie A)$.
  For if $x\bowtie B$ and $y\in B$ as in local decomposability, then $x\bowtie \singleton{y}$.
  Moreover, weak local decomposability implies that $\oapt$ is a comparison, by taking $A = \singleton{y}$.

  Finally, if $X$ is a prometric space and we have a $d$ with $d(x,y)>0$, then taking $\ep=\frac12 d(x,y)$ we find $x\bowtie \singleton{y}$.
  Conversely, if $x\bowtie \singleton{y}$, then we have $d,\ep$ with $\forall z, (z\in \singleton{y} \implies d(x,z)>\ep)$, which is to say $d(x,y)>\ep$, hence $d(x,y)>0$.
\end{proof}

\begin{defn}
  Let $X$ be a topological neighborhood space.
  \begin{enumerate}
  \item $X$ is $\mathbf{T_0}$ if $(x\leapx y \land y\leapx x) \implies x=y$ (i.e.\ $\leapx$ is antisymmetric).
  \item $X$ is $\mathbf{T_1}$ if $x\leapx y \implies x=y$ (i.e.\ $\leapx$ coincides with equality).
  \item $X$ is $\mathbf{R_0}$ if $\leapx$ is symmetric (hence an equivalence relation).
  \end{enumerate}
  Let $X$ be a topological apartness space.
  \begin{enumerate}
  \item $X$ is $\mathbf{T_0}$ if $(\neg(x\oapt y) \land \neg(y\oapt x)) \implies x=y$ (i.e.\ $\oapt$ is connected).
  \item $X$ is $\mathbf{T_1}$ if $\neg(x\oapt y)\implies x=y$ (i.e.\ $\oapt$ is tight).
  % \item $X$ is $\apart$-$\mathbf{T_1}$ if $x\apart y \implies x\oapt y$, for some tight relation $\apart$.
  \item $X$ is \textbf{strongly} $\mathbf{R_0}$ if $\oapt$ is symmetric (hence, if $X$ is also locally decomposable, $\oapt$ is an apartness relation).
  \end{enumerate}
\end{defn}

\begin{thm}
  Let $X$ be a prometric space.
  \begin{enumerate}
  \item $X$ is $T_1$ or $T_0$ if and only if its underlying topology is so.
  \item If $X$ is symmetric, then its underlying topology is strongly $R_0$.
  \end{enumerate}
\end{thm}
\begin{proof}
  Obvious.
\end{proof}

\begin{thm}\label{thm:ldtop-ord}
  If $X$ is a locally decomposable topological space, then for any $x,y\in X$ we have
  \[ (x\leapx y) \iff \neg(x\oapt y) \]
  and the two definitions of $T_1$ and $T_0$ above agree, while strong $R_0$ implies $R_0$.
\end{thm}
\begin{proof}
  First let $x\leapx y$, so that $\forall A, (x\ll A \implies y\ll A)$, and suppose for contradiction that $x\oapt y$, i.e.\ $x\bowtie \singleton{y}$.
  The latter means by definition that $x\ll \cpl{\singleton{y}}$, so by assumption we have $y\ll \cpl{\singleton{y}}$, a contradiction since $y\notin \cpl{\singleton{y}}$.

  On the other hand, suppose $\neg(x\oapt y)$, and let $x\ll A$; we will show $y\ll A$.
  By local decomposability we have a $B$ with $x\ll B$ and $\forall z, (z\ll A \lor z\notin B)$.
  Thus, to show $y\ll A$ it suffices to show that $y\notin B$ leads to a contradiction.
  But if $y\notin B$ then $B\subseteq \cpl{\singleton{y}}$, so $x\ll \cpl{\singleton{y}}$ by isotony and thus $x\bowtie \singleton{y}$, contradicting $\neg(x\oapt y)$.

  The remaining statements are obvious.
\end{proof}

In keeping with our categorical perspective, we observe also that \cref{thm:ldtop-ord} can be promoted to a natural transformation.

\begin{thm}
  Let $\mathbf{Refl}$ and $\mathbf{Irref}$ denote the categories of reflexive and irreflexive relations respectively, with morphisms defined to preserve and anti-preserve the relation as in $\Preord$ and $\APreord$ respectively.
  Then the constructions of \cref{thm:top-ord} generalize to functors $\PTop \to \mathbf{Refl}$ and $\APTop \to \mathbf{Irref}$, and we have a mate-pair of natural transformations lying over the identity in $\Set$:
  \[
  \xymatrix{ \PTop \ar[r] \ar[d]_{\anti} \drtwocell\omit & \mathbf{Refl} \ar[d]^{\anti} \\
    \APTop \ar[r]  & \mathbf{Irref}  }
  \qquad
  \xymatrix{ \PTop \ar[r]  & \mathbf{Refl}   \\
    \APTop \ar[r] \ar[u]^{\neigh} \urtwocell\omit & \mathbf{Irref}\ar[u]_{\neigh} }
  \]
  of which the second becomes an isomorphism when restricted to locally decomposable spaces:
  \[ \xymatrix{ \ldTop \ar[r]  & \Preord   \\
    \ldATop \ar[r] \ar[u]^{\neigh}_{\simeq} \urtwocell\omit{\cong} & \APreord \ar[u]_{\neigh} }
  \]
\end{thm}
\begin{proof}
  First let $f:X\to Y$ be a continuous map of pretopological neighborhood spaces, and $x\leapx y$ in $X$.
  If $f(x)\ll A$ in $Y$, then $x\ll f\inv(A)$ in $X$, hence $y\ll f\inv(A)$ since $x\leapx y$, and thus $f(y)\ll A$.
  Thus $f(x)\leapx f(y)$, and we have a functor $\PTop \to \mathbf{Refl}$.

  Second, let $f:X\to Y$ be a continuous map of pretopological apartness spaces, and $f(x)\oapt f(y)$ in $Y$.
  Then $f(x) \bowtie \singleton{ f(y)} = f(\singleton{y})$, so $x\bowtie \singleton{y}$ and $x\oapt y$.
  Thus we have a functor $\APTop \to \mathbf{Irref}$.

  By the mate-correspondence, it suffices to construct the right-hand transformation.
  Thus let $X$ be a pretopological apartness space.
  In the putative domain of the transformation, $x\leapx y$ means $\forall A, (x\ll A \implies y\ll A)$ in $\neigh(X)$, while in the putative codomain, $x\leapx y$ means $\neg (x\bowtie \singleton{y})$.
  Assume the former, and for contradiction that $x\bowtie \singleton{y}$.
  Then $x\ll \cpl{\singleton{y}}$ in $\neigh(X)$, whence $y\ll \cpl{\singleton{y}}$, but this is a contradiction since $y\notin \cpl{\singleton{y}}$.

  The fact that this becomes an isomorphism on locally decomposable spaces is the $\Leftarrow$ direction of \cref{thm:ldtop-ord}.
\end{proof}

In fact, the functors $\PTop \to \mathbf{Refl}$ and $\APTop \to \mathbf{Irref}$ defined above have left adjoints:

\begin{eg}\label{eg:alexandrov}
  Any reflexive relation $\leapx$ induces a pretopological neighborhood relation where $x\ll A$ means $\forall y, (x\leapx y \implies y\in A)$.
  When $\leapx$ is transitive and hence a preorder, this $\ll$ is topological; indeed it is the standard \textbf{Alexandrov topology} of a preorder.
  The functor taking a reflexive relation or preorder to its Alexandrov (pre)topology is left adjoint to the functor $\PTop \to \mathbf{Refl}$ or $\Top \to \Preord$, and the spaces obtained in this way are precisely those with the property that whenever $x\ll A_i$ for all $i$ we have $x\ll \bigcap_i A_i$.
  Note that the Alexandrov topology is locally decomposable if and only if $\leapx$ is decidable, and that it includes the case of discrete topologies when $\leapx$ is equality.
  
  % isotony and additivity are obvious, while reflexivity for $\ll$ follows from reflexivity for $\leapx$.
  % For transitivity, if $x\ll A$, so that $\forall y, (x\leapx y \implies y\in A)$, to show $x\ll \setof{y|y\ll A}$ we must show that if $x\leapx y$ then $y\ll A$, i.e.\ if $y\leapx z$ then $z\in A$.
  % But transitivity of $\leapx$ gives $x\leapx z$, so $z\in A$ by assumption.
  % Note that this \emph{Alexandrov neighborhood space} is locally decomposable if and only if $\leapx$ is decidable, i.e.\ $\forall x\forall y, (x\leapx y \lor x\not\leapx y )$.

  % If $X$ is a preorder and $Y$ a topological neighborhood space, then $f:X\to Y$ is continuous for this structure if and only if $f(x) \ll A$ implies $\forall y, (x\leapx y \implies y\in f\inv(A))$.
  % Put differently, this means that if $x\leapx y$, then $f(x)\ll A$ implies $f(y)\ll A$, i.e.\ $x\leapx y \implies f(x)\leapx_Y f(y)$, where $\leapx_Y$ is defined as in \cref{thm:top-ord}.
  % This gives adjointness.

  Dually, any irreflexive relation $\oapt$ induces a pretopological apartness relation, where $x\bowtie A$ means $\forall y, (y\in A \implies x\oapt y)$, which we might call the \textbf{Alexandrov apartness}.
  This defines a left adjoint to the functor $\APTop \to \mathbf{Irref}$, and the apartness spaces obtained in this way are precisely those in which $x\bowtie A_i$ for all $i$ implies $x\bowtie \bigcup_i A_i$.
  However, the Alexandrov apartness is not usually topological; even the comparison property $x\oapt y \lor y\oapt z$ for $\oapt$ seems insufficient, constructively, to ensure transitivity of $\bowtie$.
\end{eg}

The other pair of separation axioms we will be interested in are regularity and complete regularity.
We define them only for neighborhood spaces, since as we will see below they both imply local decomposability.

\begin{defn}
  Let $X$ be a topological neighborhood space.
  \begin{enumerate}
  \item $X$ is \textbf{regular} if whenever $x\ll A$, there are a $B$ and $C$ such that $x\ll B$, $B\cap C = \emptyset$, and $\forall y, (y\ll A \lor y\ll C)$.
  \item $X$ is \textbf{completely regular} if whenever $x\ll A$, there is a continuous function $f:X\to \R$ such that $f(x)=0$ and $\forall y, (f(y)<1 \implies y\in A)$.
  \end{enumerate}
\end{defn}

\begin{lem}\label{thm:creg-reg}
  A completely regular space is regular.
\end{lem}
\begin{proof}
  Given $x\ll A$, find $f$ as in complete regularity, and let $B = \setof{y|f(y)<\frac12}$ and $C = \setof{y|f(y)>\frac12}$.
  Then $x\ll B$ by continuity of $f$ and the assumption $f(x)=0$, and clearly $B\cap C = \emptyset$.
  For any $y$, we have either $f(y)>\frac12$ or $f(y)<1$.
  In the former case, we have $y \ll C$ by continuity.
  In the latter case, we have $y \ll \setof{z|f(z)<1}$ by continuity, hence $y\ll A$ by isotony and the assumption on $f$.
\end{proof}

\begin{thm}
  A regular space is both locally decomposable and strongly $R_0$.
\end{thm}
\begin{proof}
  Local decomposability is clear since $B\cap C=\emptyset$ means that $y\ll C \implies y\notin B$.
  For strong $R_0$, suppose $x\oapt y$, i.e.\ $x\bowtie \singleton{y}$, i.e.\ $x\ll \cpl{\singleton{y}}$.
  By regularity we have $B,C$ with $x\ll B$, $B\cap C = \emptyset$, and $\forall z, (z\ll \cpl{\singleton{y}} \lor z\ll C)$.
  Since $y\not\ll \cpl{\singleton{y}}$, we have $y\ll C$; but $x\notin C$ so $C\subseteq \cpl{\singleton{x}}$.
  Thus $y\ll\cpl{\singleton{x}}$ by isotony, so $y\oapt x$.
\end{proof}

\begin{thm}\label{thm:sympmet-reg}
  If $X$ is a symmetric prometric space, then its underlying topology is regular.
\end{thm}
\begin{proof}
  Given $x\ll A$, we have $d_1,\ep$ such that $\forall y, (d_1(x,y)<\ep \implies y\in A)$.
  Let $d_2$ be as in prometric transitivity for $d_1$, and define $B = \setof{y|d_2(x,y)<\hfep}$ and $C = \setof{y|d_2(x,y)>\hfep}$.
  Then clearly $x\ll B$ and $B\cap C = \emptyset$.

  Now for any $y$, we have either $d_2(x,y)<\frac{2\ep}3$ or $d_2(x,y)>\hfep$.
  First suppose $d_2(x,y)<\frac{2\ep}3$; we claim $y\ll A$.
  Suppose $z$ is such that $d_2(y,z)<\frac{\ep}{3}$; then $d_1(x,z) \le d_2(x,y)+d_2(y,z) < \frac{2\ep}{3} + \frac{\ep}{3} = \ep$.
  Hence, by assumption, $z\in A$.
  Thus $\forall z, (d_2(y,z)<\frac{\ep}{3} \implies z\in A)$, so $y\ll A$.

  Now suppose $d_2(x,y)>\hfep$; we claim $y\ll C$.
  Let $0<\ep' < d_2(x,y)-\hfep$, let $d_3$ be as in prometric transitivity for $d_2$, and let $d_4$ be as in prometric symmetry for $d_3$.
  Suppose $z$ is such that $d_4(y,z)<\ep'$; then $d_3(z,y)<\ep'$.
  Moreover, $d_2(x,y) \le d_3(x,z) + d_3(z,y) < d_3(x,z) + \ep'$, so $d_3(x,z) > d_2(x,y) - \ep' > \hfep$.
  Thus $z\in C$.
  Therefore $\forall z, (d_4(y,z)<\ep' \implies z\in C)$, so $y\ll C$.
\end{proof}

Note the similarity between the proofs of \cref{thm:creg-reg} and \cref{thm:sympmet-reg}: in the latter we use a distance whereas in the former we use an unknown continuous function.
This suggests that prometric spaces should in fact be completely regular with distances playing the role of the separating functions; but only in the gauge case can we show that distances are continuous.

\begin{thm}\label{thm:symgauge-creg}
  If $X$ is a (symmetric) gauge space, then its underlying topology is completely regular.
\end{thm}
\begin{proof}
  Given $x\ll A$, we have a gauging distance $d$ and an $\eta>0$ such that $\forall y, (d(x,y)<\eta \implies y\in A)$.
  Let $f(y) = \frac1{\eta} d(x,y)$; it clearly suffices to show that $f$ is continuous.
  In fact we will show that $f$ is uniformly continuous.
  Thus, suppose given $\ep$; we must find a gauging distance $d'$ and a $\de>0$ such that for any $y,z\in X$, if $d'(y,z)<\de$ then $|f(y)-f(z)|<\ep$.
  Let $d'$ be a gauging distance such that $d(u,v)\le d'(u,v)$ and also $d(v,u) \le d'(u,v)$ for all $u,v\in X$, which exists by symmetry and binary filtration, and let $\de = \eta\ep$.
  Suppose $d'(y,z)< \de= \eta\ep$; then by the triangle inequality we have
  \begin{gather*}
    d(x,z) \le d(x,y)+d(y,z) < d(x,y) + d'(y,z) < d(x,y)+\eta\ep\\
    d(x,y) \le d(x,z)+d(z,y) < d(x,z) + d'(y,z) < d(x,z)+\eta\ep
  \end{gather*}
  Thus
  \[ |f(y)-f(z)| = |\textstyle\frac1{\eta}d(x,y) - \frac1{\eta}d(x,z)| < \ep \]
  as desired.
\end{proof}

In classical mathematics, prometric spaces are also completely regular (with a less direct proof), since they are uniformizable (see \cref{sec:uniformity}).
But in the absence of excluded middle and countable choice, this seems no longer true.

Classically, complete regularity also completely determines the gauge spaces: every completely regular space can be given by a gauge.
\fxnote{Is that also true constructively?}

\cref{thm:sympmet-reg} and \cref{thm:symgauge-creg} do depend crucially on symmetry.
Classically, \emph{any} topological space can be given by a quasi-gauge (although constructively, even a prometric space satisfies the nontrivial condition of local decomposability).


\subsection{Comparing definitions}
\label{sec:top-compare}

Our definition of topological apartness space is clearly inspired by the point-set apartness spaces of Bridges and Vita~\cite[Chapter 2]{bridges-vita}, but there are several minor differences.

Firstly, they assume $X$ to be inhabited, whereas we follow instead the lesson of category theory that trivial examples should not be arbitrarily excluded.
In particular, an assumption of inhabitedness would destroy \cref{thm:top-topconcrete} by removing the initial object.

Secondly, they assume that the set $X$ comes with a given symmetric irreflexive relation $\apart$ (they write it as $\neq$), and modify various of the axioms to refer to this relation rather than the denial inequality $\neg(x=y)$ (which, recally, is what \emph{we} mean by ``$x\neq y$'').
In particular, their reflexivity axiom is
\begin{equation}
  x\bowtie A \implies \forall y\in A, (x\apart y)\label{eq:top-apart-refl}
\end{equation}
which implies ours since $\apart$ is irreflexive, and reduces to ours if $\apart$ is $\neq$.
Note that this is equivalent to
\[ (x\oapt y) \implies (x\apart y) \]
where $\oapt$ is defined as in \cref{thm:top-ord}.
Thus, if in any pretopological apartness space (in our sense) we define $x\apart y$ to mean $(x\oapt y)\lor (y\oapt x)$, we get a symmetric irreflexive relation satisfying~\eqref{eq:top-apart-refl}.
We tend to think that not much generality is lost by defining $\apart$ in terms of the topology this way, rather than postulating it from the beginning; this is further supported by the fact that their $T_1$ separation axiom is
\[ (x\apart y) \implies (x\oapt y) \]
so that in a $T_1$ apartness space as they define it, their postulated $\apart$ coincides with our defined $\oapt$.
Their $T_1$ axiom implies ours as long as $\apart$ is itself tight.

Thirdly, their definition of a point-set apartness space (as opposed to what they call a ``pre-apartness space'') also includes the following axiom:
\[ x\bowtie A \implies \forall y, (x\apart y \lor y\bowtie A). \]
If $\apart$ coincides with $\oapt$, then this axiom becomes the statementthat in the proof of \cref{thm:top-ord} we called \emph{weak local decomposability}.
As with local decomposability, we regard it as a separation axiom rather than something that should be part of a definition.

Finally, and most importantly, they use a weaker transitivity axiom:
\begin{equation}
  x\bowtie A \implies x \bowtie \setof{ y | \forall z, (z\bowtie A \implies z\apart y)}.\label{eq:top-wktrans}
\end{equation}
This is clearly implied by our transitivity axiom, since $\forall z, (z\bowtie A \implies z\apart y)$ implies $y\not\bowtie A$.
However, it seems too weak even in classical mathematics.
For instance, if $X = \{x,y,z\}$ with an irreflexive relation defined by $x\apart z$ and $z\apart x$ and nothing else, then the corresponding Alexandrov pretopological apartness space (\cref{eg:alexandrov}) satisfies~\eqref{eq:top-wktrans}; but classically it is a pretopological space that is not topological.
Moreover,~\eqref{eq:top-wktrans} also destroys \cref{thm:top-topconcrete}; indeed it is not even inherited by subspaces.

It is worth noting that in the presence of~\eqref{eq:top-wktrans} and~\eqref{eq:top-apart-refl}, our stronger transitivity axiom is equivalent to what~\cite{bridges-vita} calls the \textbf{reverse Kolmogorov property}: whenever $x\bowtie A$ and $y\not\bowtie A$ then $x\apart y$.
This is equivalent to saying $\setof{y|y\not\bowtie A} \subseteq \setof{ y | \forall z, (z\bowtie A \implies z\apart y)}$, which together with~\eqref{eq:top-wktrans} and isotony implies our transitivity axiom.
On the other hand, assuming our transitivity axiom, if $x\bowtie A$ and $y\not\bowtie A$, then since $x\bowtie \setof{y|y\not\bowtie A}$, hence by~\eqref{eq:top-apart-refl} we have $x\apart y$.
Thus, the differences are fairly minor.

If $\apart$ coincides with $\neq$, then our functor $\anti$ constructs what~\cite{bridges-vita} call the \emph{topological apartness} associated to a topological space.
Our functor $\neigh$ is not mentioned therein.
Its adjointness to $\anti$ makes it clearly of categorical interest, but it is also obviously problematic in that it doesn't preserve transitivity.
Instead they use the following construction, called the \emph{apartness topology}:

\begin{thm}\label{thm:aptop}
  In any pretopological apartness space $X$, define $x\ll A$ to mean
  \begin{equation}
    \label{eq:top-bowtie-ll-1}
    \exists B, (x\bowtie B \land \forall y, (y\bowtie B \implies y\in A)).
  \end{equation}
  Then $X$ becomes a topological neighborhood space, denoted $\neigh'(X)$.
  Moreover:
  \begin{enumerate}
  \item If $X$ is a topological apartness space, then $\anti(\neigh'(X)) \cong X$.\label{item:aptop1}
  \item If $X$ is a \nn-stable topological neighborhood space, then $\neigh'(\anti(X)) \cong X$.\label{item:aptop2}
  \end{enumerate}
\end{thm}
\begin{proof}
  Isotony is clear, and additivity follows from additivity for $\bowtie$.
  For transitivity, note that $x\ll A$ if and only if there is a set of the form $\setof{y|y\bowtie B}$ containing $x$ and contained in $A$.
  Thus, $\setof{y|y\ll A}$ is the union of all sets of the form $\setof{y|y\bowtie B}$ contained in $A$.
  Since any such set is also contained in that union, if $x\ll A$ we have $x\ll \setof{y|y\ll A}$, as desired.
  (In more traditional language, the sets $\setof{y|y\bowtie B}$ are a basis for the topology of $\neigh'(X)$.)

  Now by definition we have $x\bowtie A$ in $\anti(\neigh'(X))$ if and only if $x\ll \cpl{A}$ in $\neigh'(X)$, meaning there is a $B$ such that $x\bowtie B$ in $X$ and $\forall y, (y\bowtie B \implies y\in \cpl{A})$.
  This certainly holds if $x\bowtie A$: take $B=A$.
  But conversely, it implies $A\subseteq \setof{y|y\not\bowtie B}$, and $x\bowtie\setof{y|y\not\bowtie B}$ by transitivity for $X$, so $x\bowtie A$ by isotony; this gives~\ref{item:aptop1}.

  Finally, for~\ref{item:aptop2}, if $x \ll A$ in $\neigh'(\anti(X))$, then there is a $B$ such that $x\ll \cpl{B}$ and $\forall y, (y\ll \cpl{B} \implies y\in A)$, i.e.\ $x\in \int(\cpl{B}) \subseteq A$.
  This certainly implies $x\ll A$ (as long as $X$ is topological), while the converse follows from \nn-stability.
\end{proof}

Unfortunately, $\neigh'$ does not seem to be a functor $\ATop\to \Top$ at all.
If $f:X\to Y$ is $\bowtie$-continuous and $f(x)\ll A$ in $\neigh' Y$, then we have $B\subseteq Y$ with $f(x)\bowtie B$ and $\forall y\in Y, (y\bowtie B \implies y\in A)$.
Since $f(f\inv(B)) \subseteq B$, we have $f(x)\bowtie f(f\inv(B))$ and thus $x\bowtie f\inv(B)$, while for all $z\in X$ we have $f(z)\bowtie B \implies f(z)\in A$, i.e.\ $f(z)\bowtie B \implies z\in f\inv(A)$.
But $f(z)\bowtie B$ is not implied by $z\bowtie f\inv(B)$.
If we replace $B$ by $\setof{y|y\not\bowtie B}$, allowing us to assume that $\forall y, (y\not\bowtie B \implies y\in B)$, we can conclude that $f(z)\not\bowtie B$ implies $f(z)\in B$, so that $z\bowtie f\inv(B)$ implies $f(z) \notin B$ and hence $\neg(f(z)\not\bowtie B)$, but this is still not yet $f(z)\bowtie B$.

However, it is easy to check that if $X$ is a locally decomposable apartness space, then $\neigh(X) \cong \neigh'(X)$, and both definitions of $x\ll A$ are also equivalent to:
\begin{equation}
    %\exists B, (x\bowtie B \land \forall y, (y\bowtie B \implies y\in A))\\%\label{eq:top-bowtie-ll-1}\\
  \exists B, (x\bowtie B \land \forall y, (y\in A \lor y\in B)).\label{eq:top-bowtie-ll-2}
\end{equation}

\begin{rmk}
  The frequent use of the non-functorial construction $\neigh'$ in~\cite[Chapter 2]{bridges-vita} does tend to make a category theorist suspicious.
  For instance, they define:
  \begin{itemize}
  \item \emph{convergence} in an apartness space $X$ to be simply topological convergence in $\neigh'(X)$,
  \item the \emph{weak nested neighborhoods} property for an apartness space $X$ to be essentially \nn-stability of $\neigh'(X)$, and
  \item the \emph{product} of apartness spaces $X$ and $Y$ to be essentially $\anti(\neigh'(X) \times \neigh'(Y))$.
  \end{itemize}
  To a category theorist, this suggests that the ``real'' objects of interest in~\cite[Chapter 2]{bridges-vita} are the topological \emph{neighborhood} spaces of the form $\neigh'(X)$ for some apartness space $X$, or equivalently those such that $\neigh'(\anti(X))\cong X$.
  In~\cite{bridges-vita} such spaces are called \emph{topologically consistent}: they are the topological spaces in which the interiors of complements form a basis for the topology.
\end{rmk}


\section{Families of point-point relations: uniformity}
\label{sec:uniformity}

\cref{thm:promet-top} shows that topological neighborhood or apartness spaces are sufficient to capture the topological information in a prometric space.
However, there is also the more refined \emph{uniform} information, as defined by the category of uniformly continuous functions.
The standard way to divorce uniformity from real numbers is to consider \emph{families} of point-point relations.

\begin{defn}\label{def:pmet-unif}
  Let $X$ be a prometric space, $d$ a distance, $\ep>0$ a real number, and $x,y\in X$.
  \begin{enumerate}
  \item We say $x \leapx_{d,\ep} y$ if $d(x,y)<\ep$.
  \item We say $x \oapt_{d,\ep} y$ if $d(x,y)>\ep$.
  \end{enumerate}
\end{defn}

The abstract structures capturing these relations are the following.
We will use Greek letters $\al,\be,\gm$ to denote special binary relations containing the diagonal, with $(x,y)\in \al$ written as $x\leapx_\al y$.
Similarly, we will use $\rho,\si,\tau$ to denote special binary relations disjoint from the diagonal, with $
(x,y)\in\rho$ written $x \oapt_\rho y$.

We write $\neg\al$ for the complement of a relation $\al$, for which we also invert the notation $\leapx/\oapt$.
That is, $(x \oapt_{\neg\al} y)$ means $\neg (x\leapx_{\al} y)$ and similarly.
We write $\al\implies\be$ to mean that $\forall x\forall y,(x\leapx_\al y \implies x\leapx_\be y)$ or similarly (i.e.\ $\al\subseteq \be$ as subsets of $X\times X$).

\begin{defn}
  A \textbf{quasi-uniform space} is a set $X$ together with a family of binary relations, called \textbf{entourages}, satisfying the following axioms.
  \begin{enumerate}
  \item If $\al$ is an entourage and $\al\implies\be$, then $\be$ is an entourage (isotony).
  \item There exists an entourage (nullary filtration).
  \item If $\al$ and $\be$ are entourages, there exists an entourage $\gm$ such that $\gm\implies\al$ and $\gm\implies\be$ (binary filtration).
  \item We have $x\leapx_\al x$ for all entourages $\al$ and all $x\in X$ (reflexivity).
  \item For any entourage $\al$, there exists an entourage $\be$ such that for any $x,y,z\in X$, if $x\leapx_\be y$ and $y\leapx_\be z$, then $x\leapx_\al z$ (transitivity).
  \end{enumerate}
  It is a \textbf{uniform space} if it also satisfies the following:
  \begin{enumerate}[resume]
  \item For any entourage $\al$, there is an entourage $\be$ such that for any $x,y\in X$, if $x\leapx_\be y$ then $y\leapx_\al x$ (symmetry).
    By isotony, there is then a base (see below) of symmetric entourages, which we usually write $\approx_\al$ instead of $\leapx_\al$.
  \end{enumerate}
  A quasi-uniform space is\dots
  \begin{enumerate}[resume]
  \item \textbf{\nn-stable} if for any entourage $\al$, there is an entourage $\be$ such that $\neg\neg\be\implies \al$. %, i.e.\ $\forall x\forall y, (\neg\neg(x\leapx_\be y) \implies x\leapx_\al y)$.
  \item \textbf{locally decomposable} if for any entourage $\al$, there is an entourage $\be$ such that for any $x,y\in X$, either $x\leapx_\al y$ or $\neg(x\leapx_\be y)$.
  \end{enumerate}
  If $X$ and $Y$ are quasi-uniform spaces, a function $f:X\to Y$ is \textbf{uniformly continuous} if for any entourage $\al$ in $Y$ there is an entourage $\be$ in $X$ such that $\forall x\forall y, (x\leapx_\be y \implies f(x)\leapx_\al f(y))$.
  We write $\Unif$ for the category of quasi-uniform spaces and uniformly continuous maps, and similarly $\Unifnn$ and $\ldUnif$ for its full subcategories of \nn-stable and locally decomposable spaces.
\end{defn}

Uniform spaces are well-known in classical mathematics.
Constructively, some authors\fxwarning{cite} include uniform local decomposability as part of the definition, but we regard it as a separation axiom to be imposed only when required.
For instance, any topological group is a uniform space in the usual way, but it need not be locally decomposable.
Likewise, any set has a discrete uniformity in which all reflexive relations are entourages, but this is locally decomposable only when the set has decidable equality.

Less well-known is the dual notion of uniform apartness.

\begin{defn}
  A \textbf{quasi-uniform apartness space} (or \textbf{anti-quasi-uniform space}) is a set $X$ together with a family of binary relations, called \textbf{anti-entourages}, satisfying the following axioms.
  \begin{enumerate}
  \item If $\rho$ is an anti-entourage and $\si\implies\rho$, then $\si$ is an anti-entourage (isotony).
  \item There exists an anti-entourage (nullary filtration).
  \item If $\rho$ and $\si$ are anti-entourages, there exists an anti-entourage $\tau$ such that $\rho\implies\tau$ and $\si\implies\tau$ (binary filtration).
  \item We have $\neg(x\oapt_\rho x)$ for all anti-entourages $\rho$ and all $x\in X$ (reflexivity).
  \item For any anti-entourage $\rho$, there exists an anti-entourage $\si$ such that for any $x,y,z\in X$, if $x\oapt_\rho z$ and $\neg(y\oapt_\si z)$, then $x\oapt_\si y$ (bilocal transitivity).
  \end{enumerate}
  It is a \textbf{uniform apartness space} (or \textbf{anti-uniform space}) if it also satisfies:
  \begin{enumerate}[resume]
  \item For any anti-entourage $\rho$, there is an anti-entourage $\si$ such that for any $x,y\in X$, if $x\oapt_\rho y$ then $y\oapt_\si x$ (symmetry).
    By isotony, there is then a base (see below) of symmetric anti-entourages, which we usually write $\apart_\rho$.
  \end{enumerate}
  A quasi-uniform apartness space is\dots
  \begin{enumerate}[resume]
  \item \textbf{\nn-stable} if for any anti-entourage $\rho$, there is an entourage $\si$ such that $\neg\neg\rho \implies \si$. %, i.e.\ $\forall x\forall y, (\neg\neg(x\oapt_\rho y) \implies x\oapt_\si y)$.
  \item \textbf{locally decomposable} if for any anti-entourage $\rho$, there is an anti-entourage $\si$ such that for any $x,y\in X$, either $x\oapt_\si y$ or $\neg(x\oapt_\rho y)$.
    Note that then automatically $\rho\implies\si$.
  \item \textbf{bilocally decomposable} if for any anti-entourage $\rho$, there is an anti-entourage $\si$ such that for any $x,y,z\in X$, if $x\oapt_\rho z$ then either $x\oapt_\si y$ or $y\oapt_\si z$.
  \end{enumerate}
  If $X$ and $Y$ are quasi-uniform apartness spaces, a function $f:X\to Y$ is \textbf{uniformly continuous} if for any anti-entourage $\al$ in $Y$ there is an anti-entourage $\be$ in $X$ such that $\forall x\forall y, (f(x)\oapt_\al f(y) \implies x\oapt_\be y)$.
  We write $\AUnif$ for the category of quasi-uniform apartness spaces and uniformly continuous maps, and similarly $\AUnifnn$ and $\ldAUnif$ for its full subcategories of \nn-stable and locally decomposable spaces.
\end{defn}

Note that the ``bilocal transitivity'' condition for a uniform apartness is weaker than what we have called bilocal decomposability.
Just as a quasi-uniform space with a smallest entourage can be identified with a preorder, an anti-quasi-uniform space with a largest anti-entourage can be identified with an anti-preorder (\cref{def:anti-preorder}).
However, we note:

\begin{lem}
  If a quasi-uniform apartness space is locally decomposable, then it is bilocally decomposable.
\end{lem}
\begin{proof}
  Given $\rho$, let $\si$ be as in transitivity, and then let $\tau$ be as in local decomposability for $\si$.
  Now suppose $x\oapt_\rho z$.
  We have either $\neg(y\oapt_\si z)$ or $y\oapt_\tau z$; but in the former case transitivity gives $x\oapt_\si y$.
  Since $\si\implies\tau$, we have $x\oapt_\tau y$ or $y\oapt_\tau z$, as desired.
\end{proof}

As usual, a \textbf{base} for a uniformity is a subset of ``basic'' entourages such that every entourage contains a basic one.
Dually, a base for an anti-uniformity is a subset of basic anti-entourages such that every anti-entourage is contained in a basic one.
A set of entourages or anti-entourages is a base for \emph{some} uniformity or anti-uniformity exactly when it satisfies all of the axioms except isotony.
(We have stated the axioms in such a way as to make this true, though in the presence of isotony the filtration axioms have a simpler form.)

\begin{thm}\label{thm:pmet-unif}
  For any prometric space $X$, \cref{def:pmet-unif} gives bases for a locally decomposable quasi-uniformity and a locally decomposable anti-quasi-uniformity, which are symmetric if $X$ is.
\end{thm}
\begin{proof}
  In both cases nullary filtration follows from nullary filtration of distances.
  For binary filtration, given $(d_1,\ep_1)$ and $(d_2,\ep_2)$, let $d_3$ be as in binary filtration for distances; then $(d_3,\min(\ep_1,\ep_2))$ is what we want.
  Both reflexivity axioms follow directly from reflexivity for distances, and likewise symmetry follows from symmetry for distances (when it holds).
  For uniform transitivity, given $(d,\ep)$ let $d'$ be as in prometric transitivity and consider $(d',\hfep)$: if $d'(x,y)<\hfep$ and $d'(y,z)<\hfep$, then $d(x,z) \le d'(x,y)+d'(y,z)<\ep$.

  For anti-uniform transitivity, given $(d,\ep)$ let $d'$ be as in prometric transitivity and consider $(d',\fep13)$.
  If $d(x,z)>\ep$ and $\neg (d'(y,z)>\fep13)$, then $d'(y,z)\le \fep13$.
  Now $d'(x,y)$ is either $>\fep13$ or $<\fep23$; but in the latter case we have $d(x,z) \le d'(x,y)+d'(y,z) < \ep$, a contradiction.

  Finally, for uniform local decomposability, given $(d,\ep)$ consider $(d,\hfep)$;
  then for any $x,y$ we have $d(x,y)<\ep$ or $d(x,y)>\hfep$.
  The anti-uniform case is basically identical.
\end{proof}

\begin{thm}
  The categories $\Unif$ and $\AUnif$ are both topological over $\Set$.
  Moreover, their subcategories \dots are closed under initial lifts of sources, hence are also topological over $\Set$ and are reflective in their supercategory.
\end{thm}
\begin{proof}
  TODO
\end{proof}

\begin{thm}
  If $X$ is a quasi-uniform space, the complements $\neg\al$ of entourages form a base for an anti-quasi-uniformity.
  Dually, if $X$ is a quasi-uniform apartness space, the complements $\neg\rho$ of the anti-entourages form a base for a quasi-uniformity.
  These operations define an idempotent adjunction
  \[ \anti : \Unif \rightleftarrows \AUnif : \neigh. \]
  Moreover:
  \begin{enumerate}
  \item The fixed objects on both sides are exactly the \nn-stable spaces.
    Thus the adjunction restricts to an equivalence $\Unifnn \simeq \AUnifnn$.
  \item Both $\anti$ and $\neigh$ preserve local decomposability.
    Since locally decomposable (anti)-quasi-uniform spaces are \nn-stable, we have another equivalence $\ldUnif \simeq \ldAUnif$.
  \item Both $\anti$ and $\neigh$ preserve symmetry, so the above adjunction and equivalences restrict from the quasi-uniform case to the uniform case.
  \end{enumerate}
\end{thm}
\begin{proof}
  TODO
\end{proof}

\begin{thm}
  For any prometric space $X$, the quasi-uniform and anti-quasi-uniform structures of \cref{thm:pmet-unif} correspond under the equivalence $\ldUnif \simeq \ldAUnif$.
  Moreover, this defines a fully faithful functor from prometric spaces and uniformly continuous functions to $\ldUnif$ (or equivalently $\ldAUnif$).
\end{thm}
\begin{proof}
  TODO
\end{proof}

Thus, locally decomposable (quasi-)uniform spaces capture exactly the uniform information in a prometric space.
Classically, \emph{every} quasi-uniform space can be given a prometric, and indeed a quasi-gauge, and similarly in the symmetric case; but this seems not to be true constructively.
(It is true, however, if we allow distances to take values in \emph{upper} real numbers, since then from any entourage $\al$ we can define a distance by $d(x,y) = \inf\setof{ 0 | x\leapx_\al y}$.
Similarly, if we allow distances to take values in \emph{lower} real numbers, any bilocally decomposable\fxnote{Is bilocal decomposability necessary and sufficient for this?} anti-quasi-uniform space becomes quasi-gaugeable, since from any anti-entourage $\rho$ we can define a distance by $d(x,y) = \sup\setof{ q\in\mathbb{Q} | x\oapt_\rho y }$.)

\begin{thm}
  TODO: Underlying topology of uniform structures, how it commutes with the adjunctions $\anti\dashv \neigh$ and preserves local decomposability.
\end{thm}

\begin{thm}
  TODO: The orders underlying the uniform topology are the intersection of entourages and union of anti-entourages, giving a co/reflection from uniformities into orders.
\end{thm}

\begin{thm}
  The topology underlying a locally decomposable (symmetric) uniform space is regular.
\end{thm}

More about uniform regularity.



\section{Set-set relations: proximity}
\label{sec:set-set}
\label{sec:proximity}



\section{Families of set-set relations: syntopogeny}
\label{sec:syntopogeny}

TODO: Approach spaces have a distance between points and sets, definable from a metric space by infima.
Constructively this produces only an upper-real-valued distance, unless all subsets are located.
Presumably there are ``pro-approach spaces'' that arise from prometric spaces, or at least from gauge spaces.
Upper pro-approach spaces also give rise to syntopogenous spaces, but not decomposable ones.



\section{Located subspaces}
\label{sec:located}

\begin{defn}
  A subset $A\subseteq X$ is \textbf{(metrically) located} if for all $x\in X$, the set $\setof{ d(x,y) | y\in A }$ has an greatest lower bound, written $d(x,A)$.
  \fxwarning{Which direction does this go in the quasi case?}
\end{defn}

Classically, the poset $\Rp$ is a complete lattice, and thus every subset is located.
(Even the empty set: $d(x,\emptyset)=\infty$.
This is one good reason for allowing infinite distances.)
However, constructively there are ``wild'' subsets such as $\setof{x\in X | P}$, for some undecidable proposition $P$, that cannot be shown to be located in general.
\fxnote{Mention some theorems about located subsets.}


\bibliographystyle{alpha}
\bibliography{syntop}

\end{document}
